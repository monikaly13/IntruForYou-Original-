(function(q){var g=window.AmazonUIPageJS||window.P,u=g._namespace||g.attributeErrors,v=u?u("VSEComponentAssets",""):g;v.guardFatal?v.guardFatal(q)(v,window):v.execute(function(){q(v,window)})})(function(q,g,u){(function(){function v(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var b=16*Math.random()|0;return("x"==c?b:b&3|8).toString(16)})}function W(c,b){b={contentId:""+c.initialVideo.contentId,customerId:c.customerId,isForesterTrackingDisabled:c.sushiMetricsConfig.isRobot,
foresterMetadataParams:{client:c.requestMetadata.clientId,marketplaceId:c.requestMetadata.marketplaceId,method:c.requestMetadata.method,requestId:c.requestMetadata.requestId,session:c.requestMetadata.sessionId},videoUrl:c.initialVideo.videoUrl,posterSource:c.initialVideo.imageUrl,pageAsin:c.requestMetadata.pageAsin,parentId:b,vendorCode:c.initialVideo.vendorCode,shouldStartMuted:c.shouldStartMuted,shouldAutoplay:c.shouldAutoplay,shouldPreload:c.shouldPreload,useAutoplayFallback:c.useAutoplayFallback,
shouldDisableControls:c.shouldDisableControls,useCarousel:c.useCarousel,useBuyBox:c.useBuyBox,languagePreferenceStrings:c.languagePreferenceStrings,sushiMetricsConfig:{eventSource:c.sushiMetricsConfig.eventSource,endpoint:c.sushiMetricsConfig.endpoint,requestId:c.sushiMetricsConfig.requestId,sessionId:c.sushiMetricsConfig.sessionId,customerId:c.sushiMetricsConfig.customerId,refMarkers:c.sushiMetricsConfig.refMarkers,sessionType:c.sushiMetricsConfig.sessionType,placementContext:c.sushiMetricsConfig.placementContext,
marketplaceId:c.sushiMetricsConfig.marketplaceId,weblabIds:c.sushiMetricsConfig.weblabIds,pageAsin:c.sushiMetricsConfig.pageAsin,isInternal:c.sushiMetricsConfig.isInternal,isRobot:c.sushiMetricsConfig.isRobot,clientId:c.sushiMetricsConfig.clientId,creativeId:c.sushiMetricsConfig.creativeId||""},refTag:c.refTag,ospData:{vendorTrackingId:c.initialVideo.vendorTrackingId,videoReferenceId:c.initialVideo.videoReferenceId,productAsin:c.initialVideo.productAsin},useUpNextComponent:c.useUpNextComponent,isVideoImmersivePlayer:c.isVideoImmersivePlayer,
ospLinkCode:c.ospLinkCode,showClosedCaptions:c.showClosedCaptions,closedCaptionsText:c.closedCaptionsText,clientPrefix:c.clientPrefix};c.eventTimestamp&&(b.eventTimestamp=c.eventTimestamp);return b}g.vseFeatures=g.vseFeatures||{};var z=g.gatedP||{register:function(c,b,a,d,r){void 0===r&&(r=g.vseFeatures);q.now(c).execute(c+"-prereg",function(f){f||r[b]||(r[b]=!0,d.resolve(a(d)).then(function(){q.now(c).execute(c+"-reg",function(a){a||(q.log("Gated registration failed to register module!","ERROR",
c),r[b]=!1)})}))})},declare:function(c,b,a,d){void 0===d&&(d=g.vseFeatures);q.now(c).execute(c+"-prereg",function(r){r||d[b]||(d[b]=!0,q.declare(c,a))})}},l={count:function(c,b){var a=g.ue;a&&a.count("vse:csm:"+c,b)},emitSushiMetric:function(c,b,a){var d=this;b=b||"https://unagi-na.amazon.com/1/events/com.amazon.eel.vse.metricstest.nexus";a=a||0;if(!(3<=a)){var r=JSON.stringify(c).replace(/\\\\/g,""),f={params:r,paramsFormat:"json",contentType:"application/json; charset\x3dutf-8",error:function(){d.emitSushiMetric(c,
b,++a)}},t=navigator.userAgent.match(/iPhone/i),h=!1;q.now("mash").execute("vse-detect-mshop",function(){h=!0});var n=null!==t&&h;q.when("A").execute("Emit-VSE-Metrics",function(a){navigator&&navigator.sendBeacon&&!n?navigator.sendBeacon(b,r):a.post(b,f)})}},logFatal:function(c,b,a){g.ueLogError&&g.ueLogError(a,{logLevel:"FATAL",attribution:c,message:b})},logError:function(c,b,a){g.ueLogError&&g.ueLogError(a,{logLevel:"ERROR",attribution:c,message:b})}},I={makeApplicationSushiPayloadBuilder:function(c,
b){return function(a){var d={eventSource:b.eventSource,requestId:b.requestId,sessionId:b.sessionId,placementContext:b.placementContext,creativeId:b.creativeId||"",marketplaceId:b.marketplaceId,weblabIds:b.weblabIds,clientId:b.clientId,isInternal:b.isInternal.toString(),isRobot:b.isRobot.toString(),pageAsin:b.pageAsin,customerId:b.customerId,sessionType:b.sessionType||1,refMarkers:b.refMarkers,eventId:v(),timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:0,videoAsin:0,pageUrl:null!==
g.location.href?g.location.href.substring(0,500):"",videoAsinList:b.videoAsinList||""};return{events:[{data:c.$.extend(d,a)}]}}}},w={fetchLatestPageState:function(c,b){c.state.replace(b,JSON.parse(c.$("script[type\x3d'a-state'][data-a-state*\x3d"+b+"]").html()));return c.state(b)},isDefined:function(c){return"undefined"!==typeof c&&null!==c}},p={updateReftagParam:function(c,b){return p.updateQueryStringParameter(c,"ref_?","ref",b)},updateQueryStringParameter:function(c,b,a,d){b=new RegExp("([?\x26/])"+
b+"\x3d.*?(\x26|$)","i");var r=-1!==c.indexOf("?")?"\x26":"?";return c.match(b)?c.replace(b,"$1"+a+"\x3d"+d+"$2"):c+r+a+"\x3d"+d},generateUUID:function(){for(var c="",b=0;13>b;b++)c+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return c},decodeEntities:function(c){var b=document.createElement("textarea");b.innerHTML=c;return b.value},triggerShare:function(c,b,a,d){if(b){b=screen.width;var r=screen.height;a=a?a:.7*b;d=d?d:.7*r;g.open(c,"_blank",
"toolbar\x3d0,status\x3d0,width\x3d"+a+",height\x3d"+d+",top\x3d"+(r/2-d/2)+",left\x3d"+(b/2-a/2))}else g.open(c,"_self")},getPageData:function(c){return"undefined"!==typeof c.pageLevelStateKey?A.state(c.pageLevelStateKey):c.pageLevelData},buildUrl:function(c,b){b=b||{};for(var a=g.navigator&&g.navigator.userAgent&&g.navigator.userAgent.match(/iPhone/i),d=Object.keys(b),r=0<d.length&&("sms:"!==c||!a)?"?":"",a=0;a<d.length;a++)"?"!==r&&(r+="\x26"),b[d[a]]&&(r+=d[a]+"\x3d"+encodeURIComponent(b[d[a]]));
return c+r},generateReftags:function(c,b){var a,d;c=p.getPageData(c);"undefined"!==typeof c&&(a=c.clientRef,d=c.deviceTypeRef);a=a?a:"un";d=d?d:"un";c=b?b:"un";b=p.generateUUID();c="cm_sw_"+c;a=a+"_"+d+"_"+b;return{returnReftag:c+"_r_"+a,clickReftag:c+"_c_"+a}}},X={share:function(c,b){b={facebook:{shareEndpoint:"https://www.facebook.com/dialog/share",params:function(a){return{href:p.decodeEntities(a.url),display:"popup",quote:a.quote?p.decodeEntities(a.quote):"",app_id:"465632727431967"}},ref:"fb",
height:450,width:700,isWebShare:!0},pinterest:{shareEndpoint:"https://www.pinterest.com/pin/create/button",params:function(a){return{url:p.decodeEntities(a.url),media:p.decodeEntities(a.image),description:p.decodeEntities(a.description)}},ref:"pi",height:620,width:700,isWebShare:!0},twitter:{shareEndpoint:"https://twitter.com/intent/tweet",params:function(a){var b=p.decodeEntities(a.title);a=p.decodeEntities(a.url);if(b){var c=a?Math.min(a.length,20):-1;200<b.length+c+1&&(b=b.substring(0,200-(c+1+
3))+"...")}return{text:b,url:a}},ref:"tw",height:470,width:670,isWebShare:!0},email:{shareEndpoint:"mailto:",params:function(a){return{subject:p.decodeEntities(a.title),body:p.decodeEntities(a.description)+"\n"+p.decodeEntities(a.url)}},ref:"em",height:470,width:670,isWebShare:!1},sms:{shareEndpoint:"sms:",params:function(a){return{body:p.decodeEntities(a.title)+" "+p.decodeEntities(a.url)}},ref:"sm",height:470,width:670,isWebShare:!1},whatsapp:{shareEndpoint:"https://api.whatsapp.com/send",params:function(a){return{text:p.decodeEntities(a.description)+
"\n"+p.decodeEntities(a.url)}},ref:"wa",height:470,width:670,isWebShare:!1}}[b];var a=p.generateReftags(c,b.ref);c.url=p.updateReftagParam(c.url,a.returnReftag);c=p.buildUrl(b.shareEndpoint,b.params(c));p.triggerShare(c,b.isWebShare,b.width,b.height)}},y={sendRequest:function(c,b,a,d,r){c.ajax(b,{params:a,paramsFormat:"json",crossDomain:!0,method:"POST",withCredentials:!0,contentType:"application/json",success:d,error:r})}},E=function(){return function(c){this.message=c}}(),B=function(){function c(b,
a){void 0===a&&(a={refTagRecorderEndPoint:"/gp/mobile/tag/?",retryLimit:3});this.A=b;this.config=a}c.prototype.emitRefTag=function(b,a){void 0===a&&(a=0);if(!(a>=this.config.retryLimit)){var d=this;this.A.post(this.config.refTagRecorderEndPoint+"ref\x3d"+b,{error:function(){d.emitRefTag(b,++a)}})}};return c}(),J={queueComplete:!0},K=function(){function c(b,a,d){var c=this;this.player=b;this.frame=a;this.assets=[];this.currentIndex=0;this.eventEmitter=new d.EventEmitter;this.player.on("playbackComplete",
function(){c.currentIndex++;c.doPlay()})}c.prototype.play=function(b){b?this.player.play(b):this.player.play();return this};c.prototype.getCurrentTime=function(){return this.player.getCurrentTime()};c.prototype.setCurrentTime=function(b){this.player.setCurrentTime(b);return this};c.prototype.getMediaDuration=function(){return this.player.getMediaDuration()};c.prototype.mute=function(){this.player.mute();return this};c.prototype.unmute=function(){this.player.unmute();return this};c.prototype.isMuted=
function(){return this.player.isMuted()};c.prototype.resume=function(b){this.player.resume(b);return this};c.prototype.pause=function(){this.player.pause();return this};c.prototype.next=function(){this.player.stop();this.currentIndex++;this.doPlay();return this};c.prototype.previous=function(){this.player.stop();this.currentIndex--;this.doPlay();return this};c.prototype.seek=function(b){this.player.seek(b);return this};c.prototype.enqueue=function(b,a){void 0===a&&(a=this.assets.length);b instanceof
Array?(b=b.slice(),b.splice(0,0,this.assets),Array.prototype.splice.apply(this.assets,b)):this.assets.splice(a,0,b);return this};c.prototype.dequeue=function(b){var a=this,d;if("number"===typeof b)d=[b];else if(b instanceof Array){var c=b.map(function(a){return a.contentId});d=this.assets.map(function(a){return c.indexOf(a.contentId)}).filter(function(a){-1!=a})}else d=[this.assets.map(function(a,d){return d}).filter(function(d){a.assets[d].contentId==b.contentId})[0]];for(var f=0,t=d.length;f<t;f++)this.assets.splice(d[f],
1);return this};c.prototype.on=function(b,a){if(J.hasOwnProperty(b))this.eventEmitter.on(b,a);else this.player.on(b,a);return this};c.prototype.off=function(b,a){J.hasOwnProperty(b)?this.eventEmitter.off(b,a):this.player.off(b,a);return this};c.prototype.getAssets=function(){return this.assets};c.prototype.getCurrentAssetIndex=function(){return this.currentIndex-1};c.prototype.getPosition=function(){return this.player.getPosition()};c.prototype.isPlaying=function(){return this.player.isPlaying()};
c.prototype.isPaused=function(){return this.player.isPaused()};c.prototype.getVersion=function(){return this.player.getVersion()};c.prototype.destroy=function(){this.player.destroy()};c.prototype.addChild=function(b,a){this.player.addChild(b,a);return this};c.prototype.removeChild=function(b){this.player.removeChild(b);return this};c.prototype.loadNextVideoPoster=function(b){this.player.loadNextVideoPoster(b);return this};c.prototype.blur=function(){this.player.blur();return this};c.prototype.requestFullscreen=
function(){this.player.requestFullscreen();return this};c.prototype.exitFullscreen=function(){this.player.exitFullscreen();return this};c.prototype.isFullscreen=function(){return this.player.isFullscreen()};c.prototype.fluid=function(b){this.player.fluid(b);return this};c.prototype.aspectRatio=function(b){this.player.aspectRatio(b);return this};c.prototype.enableCurrentTextTrack=function(b){void 0===b&&(b="en");this.player.enableCurrentTextTrack(b);return this};c.prototype.disableCurrentTextTrack=
function(b){void 0===b&&(b="en");this.player.disableCurrentTextTrack(b);return this};c.prototype.updateTextTrack=function(b){this.player.updateTextTrack(b);return this};c.prototype.showPoster=function(b){this.player.showPoster(b);return this};c.prototype.doPlay=function(){var b=this.player.getCurrent();b?this.assets[this.currentIndex].contentId==b.contentId?this.player.play():this.player.play(this.assets[this.currentIndex]):this.assets[this.currentIndex]&&this.player.play(this.assets[this.currentIndex])};
return c}(),L=function(){function c(b,a,d,c){var f=this;this.config=a;this.libs=c;this.eventEmitter=new c.EventEmitter;this.currentAsset=d;this.initHandlers();c=document.getElementById(a.parentId);var t=document.createElement("video");d=a.parentId+"-element";t.id=d;t.className=a.isVideoImmersivePlayer?"video-js brila-vip-vjs":"video-js brila-video-js";t.setAttribute("playsinline","true");a.shouldDisableControls||t.setAttribute("controls","true");a.shouldAutoplay&&t.setAttribute("autoplay","true");
a.shouldStartMuted&&t.setAttribute("muted","true");a.shouldPreload||t.setAttribute("preload","none");c.appendChild(t);c={player:{techOrder:["html5"],textTrackSettings:!1,html5:{hls:{overrideNative:b.overrideNativePlayer()},nativeAudioTracks:!1,nativeVideoTracks:!1,nativeTextTracks:!1}}};a.isVideoImmersivePlayer&&(c.player.bigPlayButton=!1,c.player.posterImage=a.posterSource,c.player.controlBar={playToggle:!1,volumePanel:!1,currentTimeDisplay:!0,remainingTimeDisplay:!0,fullscreenToggle:!1});this.videoJS=
c=b.embed(d,a,c);document.getElementById(d).setAttribute("style","width:100%; height:100%;");this.videoJS.poster(a.posterSource);a.shouldPreload&&this.videoJS.src(a.videoUrl);this.vseMetrics=b.metrics(this.videoJS);a.isVideoImmersivePlayer?(this.videoJS.on("click",function(){f.eventEmitter.emit("playerClick")}),this.videoJS.on("touchstart",function(){f.eventEmitter.emit("playerClick")})):this.videoJS.aspectRatio("16:9");this.videoJS.on("ended",function(){f.eventHandlers.onPlaybackComplete()});this.videoJS.on("playing",
function(){f.eventHandlers.onPlaybackStart();f.config.useAutoplayFallback&&(f.eventEmitter.emit("autoplaySucceeded"),f.config.useAutoplayFallback=!1)});this.videoJS.on("cancelContinuousPlay",function(){f.eventHandlers.onCancelContinuousPlay()});this.videoJS.on("playUpNext",function(){f.eventHandlers.onPlayUpNext()});var h=this;c.ready(function(){h.eventEmitter.emit("playerLoaded")})}c.prototype.play=function(b){var a=this;if(this.isDPXDesktopFullScreenRequest(b))this.vseMetrics.setPageLoadStartTimestamp(Date.now()),
this.videoJS.play();else{var d=this.getTextTrackMode("en");b&&(this.currentAsset&&b.contentId===this.currentAsset.contentId?this.config.shouldPreload||this.videoJS.src(b.videoUrl):(this.videoJS.poster(b.imageUrl),this.videoJS.posterImage.show(),this.vseMetrics.setContentId&&this.vseMetrics.setContentId(b.contentId),this.vseMetrics.setRefTag&&this.vseMetrics.setRefTag(b.refTag?b.refTag:""),this.vseMetrics.setOspAttribution&&this.vseMetrics.setOspAttribution({vendorTrackingId:b.vendorTrackingId?b.vendorTrackingId:
"",videoReferenceId:b.videoReferenceId?b.videoReferenceId:"",productAsin:b.productAsin?b.productAsin:""}),this.videoJS.src(b.videoUrl),this.currentAsset=b));if(this.config.showClosedCaptions){this.removeCurrentTextTracks();var c=[];this.currentAsset&&this.currentAsset.closedCaptions&&(c=this.currentAsset.closedCaptions);b&&b.closedCaptions&&(c=b.closedCaptions);this.updateTextTrack(c);this.vseMetrics.updateTextTrackMetrics();"showing"===d&&this.enableCurrentTextTrack()}b=b&&b.eventTimestamp?b.eventTimestamp:
Date.now();this.vseMetrics.setPageLoadStartTimestamp(b);if(this.config.useAutoplayFallback)b=this.videoJS.play(),b!==u&&b.then(function(a){}).catch(function(d){a.eventEmitter.emit("autoplayFailed")});else return this.videoJS.play()}};c.prototype.showPoster=function(b){this.videoJS.poster(b);this.videoJS.posterImage.show();return this};c.prototype.updateTextTrack=function(b){var a=this;b.forEach(function(d){a.videoJS.addRemoteTextTrack({src:d.url,kind:"subtitles",srclang:d.locale,label:a.config.closedCaptionsText,
"default":!1},!1)})};c.prototype.enableCurrentTextTrack=function(b){void 0===b&&(b="en");this.changeTextTrackMode(b,"showing")};c.prototype.disableCurrentTextTrack=function(b){void 0===b&&(b="en");this.changeTextTrackMode(b,"disabled")};c.prototype.muted=function(b){return this.videoJS.muted(b)};c.prototype.mute=function(){this.videoJS.muted(!0);return this};c.prototype.unmute=function(){this.videoJS.muted(!1);return this};c.prototype.isMuted=function(){return this.videoJS.muted()};c.prototype.getCurrentTime=
function(){return this.videoJS.currentTime()};c.prototype.setCurrentTime=function(b){this.videoJS.currentTime(b);return this};c.prototype.getMediaDuration=function(){return isNaN(this.videoJS.duration())?0:this.videoJS.duration()};c.prototype.pause=function(){this.videoJS.pause();return this};c.prototype.resume=function(b){this.videoJS.play();return this};c.prototype.seek=function(b){this.videoJS.currentTime(b);return this};c.prototype.stop=function(){this.videoJS.pause();this.currentAsset=u;return this};
c.prototype.on=function(b,a){this.eventEmitter.on(b,a);this.videoJS.on(b,a);return this};c.prototype.off=function(b,a){return this};c.prototype.getCurrent=function(){return this.currentAsset};c.prototype.getPosition=function(){return this.videoJS.currentTime()};c.prototype.isPlaying=function(){return!this.videoJS.paused()};c.prototype.isPaused=function(){return this.videoJS.paused()};c.prototype.getVersion=function(){return"VJS"};c.prototype.destroy=function(){this.vseMetrics.publishBeforeDispose();
this.videoJS.off("ended",this.eventHandlers.onPlaybackComplete);this.videoJS.dispose();this.videoJS=null};c.prototype.addChild=function(b,a){this.videoJS.addChild(b,a);return this};c.prototype.removeChild=function(b){this.videoJS.removeChild(b);return this};c.prototype.loadNextVideoPoster=function(b){this.videoJS.poster(b);this.videoJS.posterImage.show();return this};c.prototype.aspectRatio=function(b){this.videoJS.aspectRatio(b);return this};c.prototype.requestFullscreen=function(){this.videoJS.requestFullscreen();
return this};c.prototype.exitFullscreen=function(){this.videoJS.exitFullscreen();return this};c.prototype.isFullscreen=function(){return this.videoJS.isFullscreen()};c.prototype.fluid=function(b){this.videoJS.fluid(b);return this};c.prototype.blur=function(){this.videoJS.blur();return this};c.prototype.initHandlers=function(){var b=this;this.eventHandlers={onPlaybackComplete:function(){return b.player_onPlaybackComplete()},onPlaybackStart:function(){return b.player_onPlaybackStart()},onCancelContinuousPlay:function(){return b.player_onCancelContinuousPlay()},
onPlayUpNext:function(){return b.player_onPlayUpNext()}}};c.prototype.player_onPlaybackComplete=function(){var b=this.currentAsset;this.previousAsset=this.currentAsset;this.currentAsset=u;this.previousAsset&&(this.previousAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackComplete",b)};c.prototype.player_onCancelContinuousPlay=function(){this.currentAsset=this.previousAsset;this.eventEmitter.emit("cancelContinuousPlay",this.previousAsset)};c.prototype.player_onPlayUpNext=function(){this.eventEmitter.emit("playUpNext",
this.previousAsset)};c.prototype.player_onPlaybackStart=function(){this.currentAsset&&(this.currentAsset.eventTimestamp=Date.now());this.eventEmitter.emit("playbackStart",this.currentAsset)};c.prototype.isDPXDesktopFullScreenRequest=function(b){return this.config.sushiMetricsConfig&&this.config.sushiMetricsConfig.placementContext&&-1!==this.config.sushiMetricsConfig.placementContext.indexOf("desktop_web.ImageBlock")&&b&&!b.hasOwnProperty("refTag")&&b.contentId!==this.currentAsset.contentId};c.prototype.changeTextTrackMode=
function(b,a){var d=this.videoJS.remoteTextTracks();if(d)for(var c=0;c<d.length;c++){var f=d[c];"subtitles"===f.kind&&f.language===b&&(f.mode=a)}};c.prototype.getTextTrackMode=function(b){var a=this.videoJS.remoteTextTracks();if(a)for(var d=0;d<a.length;d++){var c=a[d];if("subtitles"===c.kind&&c.language===b)return c.mode}return"disabled"};c.prototype.removeCurrentTextTracks=function(){var b=this.videoJS.remoteTextTracks();if(b)for(var a=0;a<b.length;a++)this.videoJS.removeRemoteTextTrack(b[a])};
return c}(),M=function(){function c(b,a){var d=this;this.libs=a;this.commands=[];b.then(function(a){d.playerInstance=a;d.executeCommands()})}c.prototype.executeCommands=function(){for(var b=0;b<this.commands.length;b++)this.commands[b](this.playerInstance)};c.prototype.play=function(b){var a=this;this.playerInstance?this._play(b,this.playerInstance):this.commands.push(function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._play(b,d[0])});return this};c.prototype.mute=function(){var b=
this;this.playerInstance?this._mute(this.playerInstance):this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._mute(a[0])});return this};c.prototype.unmute=function(){var b=this;this.playerInstance?this._unmute(this.playerInstance):this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._unmute(a[0])});return this};c.prototype.isMuted=function(){var b=this;if(this.playerInstance)return this._isMuted(this.playerInstance);
this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._isMuted(a[0])});return!0};c.prototype.getCurrentTime=function(){var b=this;if(this.playerInstance)return this._getCurrentTime(this.playerInstance);this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._getCurrentTime(a[0])});return 0};c.prototype.setCurrentTime=function(b){var a=this;this.playerInstance?this._setCurrentTime(b,this.playerInstance):this.commands.push(function(){for(var d=
[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._setCurrentTime(b,d[0])})};c.prototype.getMediaDuration=function(){var b=this;if(this.playerInstance)return this._getMediaDuration(this.playerInstance);this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._getMediaDuration(a[0])});return 0};c.prototype.pause=function(){var b=this;this.playerInstance?this._pause(this.playerInstance):this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=
arguments[d];return b._pause(a[0])});return this};c.prototype.resume=function(b){var a=this;this.playerInstance?this._resume(b,this.playerInstance):this.commands.push(function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._resume(b,d[0])});return this};c.prototype.stop=function(){var b=this;this.playerInstance?this._stop(this.playerInstance):this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._stop(a[0])});return this};c.prototype.seek=
function(b){var a=this;this.playerInstance?this._seek(b,this.playerInstance):this.commands.push(function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._seek(b,d[0])});return this};c.prototype.on=function(b,a){var d=this;this.playerInstance?this._on(b,a,this.playerInstance):this.commands.push(function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];return d._on(b,a,c[0])});return this};c.prototype.off=function(b,a){var d=this;this.playerInstance?this._off(b,a,this.playerInstance):
this.commands.push(function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];return d._off(b,a,c[0])});return this};c.prototype.aspectRatio=function(b){var a=this;this.playerInstance?this._aspectRatio(b,this.playerInstance):this.commands.push(function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return a._aspectRatio(b,d[0])});return this};c.prototype.getCurrent=function(){if(this.playerInstance)return this.playerInstance.getCurrent()};c.prototype.getPosition=function(){return this.playerInstance?
this.playerInstance.getPosition():0};c.prototype.isPlaying=function(){return this.playerInstance?this.playerInstance.isPlaying():!1};c.prototype.isPaused=function(){return this.playerInstance?this.playerInstance.isPaused():!1};c.prototype.getVersion=function(){return this.playerInstance?this.playerInstance.getVersion():""};c.prototype.destroy=function(){this.playerInstance&&this.playerInstance.destroy();this.playerInstance=null};c.prototype.addChild=function(b,a){this.playerInstance&&this.playerInstance.addChild(b,
a);return this};c.prototype.removeChild=function(b){this.playerInstance&&this.playerInstance.removeChild(b);return this};c.prototype.loadNextVideoPoster=function(b){this.playerInstance&&this.playerInstance.loadNextVideoPoster(b);return this};c.prototype.updateTextTrack=function(b){this.playerInstance&&this.playerInstance.updateTextTrack(b);return this};c.prototype.showPoster=function(b){this.playerInstance&&this.playerInstance.showPoster(b);return this};c.prototype.blur=function(){this.playerInstance&&
this.playerInstance.blur();return this};c.prototype.requestFullscreen=function(){var b=this;this.playerInstance?this._requestFullscreen(this.playerInstance):this.commands.push(function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];return b._requestFullscreen(a[0])});return this};c.prototype.exitFullscreen=function(){this.playerInstance&&this.playerInstance.exitFullscreen();return this};c.prototype.isFullscreen=function(){return this.playerInstance?this.playerInstance.isFullscreen():
!1};c.prototype.fluid=function(b){this.playerInstance&&this.playerInstance.fluid(b);return this};c.prototype.enableCurrentTextTrack=function(b){void 0===b&&(b="en");this.playerInstance&&this.playerInstance.enableCurrentTextTrack(b)};c.prototype.disableCurrentTextTrack=function(b){void 0===b&&(b="en");this.playerInstance&&this.playerInstance.disableCurrentTextTrack(b)};c.prototype._play=function(b,a){b?a.play(b):a.play()};c.prototype._mute=function(b){b.mute()};c.prototype._unmute=function(b){b.unmute()};
c.prototype._isMuted=function(b){return b.isMuted()};c.prototype._getCurrentTime=function(b){return b.getCurrentTime()};c.prototype._setCurrentTime=function(b,a){a.setCurrentTime(b)};c.prototype._getMediaDuration=function(b){return b.getMediaDuration()};c.prototype._pause=function(b){b.pause()};c.prototype._stop=function(b){b.stop()};c.prototype._requestFullscreen=function(b){b.requestFullscreen()};c.prototype._resume=function(b,a){a.resume(b)};c.prototype._seek=function(b,a){a.seek(b)};c.prototype._on=
function(b,a,d){d.on(b,a)};c.prototype._off=function(b,a,d){d.off(b,a)};c.prototype._destroy=function(b){b.destroy()};c.prototype._aspectRatio=function(b,a){a.aspectRatio(b)};return c}(),N=function(){function c(b){this.deps=b}c.prototype.create=function(b){var a=this,d=v(),c=new this.deps.promise(function(a,b){g[d]={resolve:a,reject:b}});q.when("brila").execute("construct-player",function(a){g[d].resolve(a)});var f=document.getElementById(b.containerId),t=b.containerId+"-container";f.innerHTML='\x3cdiv id\x3d"'+
t+'" style\x3d"width:100%; height:100%"\x3e\x3c/div\x3e';f=(new this.deps.promise(function(d,f){c.then(function(c){var e=new L(c,W(b,t),b.initialVideo,a.deps);e.on("playerLoaded",function(){d(e)})})})).then(function(a){return a});return new K(new M(f,this.deps),document.getElementById(t),this.deps)};return c}(),F=function(c,b){return b={exports:{}},c(b,b.exports),b.exports}(function(c){function b(){}function a(a,d,b){this.fn=a;this.context=d;this.once=b||!1}function d(){this._events=new b;this._eventsCount=
0}var r=Object.prototype.hasOwnProperty,f="~";Object.create&&(b.prototype=Object.create(null),(new b).__proto__||(f=!1));d.prototype.eventNames=function(){var a=[],d,b;if(0===this._eventsCount)return a;for(b in d=this._events)r.call(d,b)&&a.push(f?b.slice(1):b);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(d)):a};d.prototype.listeners=function(a,d){a=this._events[f?f+a:a];if(d)return!!a;if(!a)return[];if(a.fn)return[a.fn];d=0;for(var b=a.length,c=Array(b);d<b;d++)c[d]=
a[d].fn;return c};d.prototype.emit=function(a,d,b,c,e,r){var m=f?f+a:a;if(!this._events[m])return!1;var m=this._events[m],C=arguments.length,k,g;if(m.fn){m.once&&this.removeListener(a,m.fn,u,!0);switch(C){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,d),!0;case 3:return m.fn.call(m.context,d,b),!0;case 4:return m.fn.call(m.context,d,b,c),!0;case 5:return m.fn.call(m.context,d,b,c,e),!0;case 6:return m.fn.call(m.context,d,b,c,e,r),!0}g=1;for(k=Array(C-1);g<C;g++)k[g-1]=arguments[g];
m.fn.apply(m.context,k)}else{var l=m.length,q;for(g=0;g<l;g++)switch(m[g].once&&this.removeListener(a,m[g].fn,u,!0),C){case 1:m[g].fn.call(m[g].context);break;case 2:m[g].fn.call(m[g].context,d);break;case 3:m[g].fn.call(m[g].context,d,b);break;case 4:m[g].fn.call(m[g].context,d,b,c);break;default:if(!k)for(q=1,k=Array(C-1);q<C;q++)k[q-1]=arguments[q];m[g].fn.apply(m[g].context,k)}}return!0};d.prototype.on=function(d,b,c){b=new a(b,c||this);d=f?f+d:d;this._events[d]?this._events[d].fn?this._events[d]=
[this._events[d],b]:this._events[d].push(b):(this._events[d]=b,this._eventsCount++);return this};d.prototype.once=function(d,b,c){b=new a(b,c||this,!0);d=f?f+d:d;this._events[d]?this._events[d].fn?this._events[d]=[this._events[d],b]:this._events[d].push(b):(this._events[d]=b,this._eventsCount++);return this};d.prototype.removeListener=function(a,d,c,r){a=f?f+a:a;if(!this._events[a])return this;if(!d)return 0===--this._eventsCount?this._events=new b:delete this._events[a],this;var e=this._events[a];
if(e.fn)e.fn!==d||r&&!e.once||c&&e.context!==c||(0===--this._eventsCount?this._events=new b:delete this._events[a]);else{for(var x=0,m=[],g=e.length;x<g;x++)(e[x].fn!==d||r&&!e[x].once||c&&e[x].context!==c)&&m.push(e[x]);m.length?this._events[a]=1===m.length?m[0]:m:0===--this._eventsCount?this._events=new b:delete this._events[a]}return this};d.prototype.removeAllListeners=function(a){a?(a=f?f+a:a,this._events[a]&&(0===--this._eventsCount?this._events=new b:delete this._events[a])):(this._events=
new b,this._eventsCount=0);return this};d.prototype.off=d.prototype.removeListener;d.prototype.addListener=d.prototype.on;d.prototype.setMaxListeners=function(){return this};d.prefixed=f;d.EventEmitter=d;"undefined"!==typeof c&&(c.exports=d)}).EventEmitter,O=u,P=u;q.when("a-sheet").execute(function(c){O=c});q.when("a-popover").execute(function(c){P=c});var Q={getBottomSheet:function(){return O},getPopoverFactory:function(){return P}},Y=function(){function c(b){var a=this;this.config=b;this.activeVideoSource=
this.activeVideo="VIDEO_NOT_SELECTED";this.registered=!1;this._submitErrorCallback=function(d){a.A.trigger("vse:"+a.id+":feedback:submitted:error")};this._submitSuccessCallback=function(d){a.A.trigger("vse:"+a.id+":feedback:submitted:success")};this.A=b.A;this.pageStateName=b.pageStateName;this.buttonApi=b.buttonApi;this.id=this.config.id;b=w.fetchLatestPageState(this.A,this.pageStateName);this.feedbackForm=this.A.$("#"+this.id+"-form");this.thankYouSection=this.A.$("#"+this.id+"-ty-container");this.submitButton=
this.buttonApi("#"+this.id+"-btn-submit");b&&this.validateFormElements()&&(this.isMobile=b.isMobile,this.endpoint=b.feedbackEndpoint,this.marketplaceId=b.marketplaceId,this.pageAsin=b.pageAsin,this.customerId=b.customerId,this.bottomSheetFactory=Q.getBottomSheet(),this.popoverFactory=Q.getPopoverFactory(),this.registered||(this.A.declarative(this.id+"-btn-close","click",function(){return a.closeFeedbackForm()}),this.A.declarative(this.id+"-btn-submit","click",function(){return a.submitFeedback()}),
this.A.on("a:sheet:afterShow:"+this.id+"-sheet",function(d){a.showFeedbackForm()}),this.A.on("a:sheet:afterHide:"+this.id+"-sheet",function(d){a.hideThankYou();a.A.trigger("vse:"+a.id+":feedback:hidden")}),this.A.on("a:popover:afterShow:"+this.id+"-popover",function(d){a.showFeedbackForm()}),this.A.on("a:popover:afterHide:"+this.id+"-popover",function(d){a.hideFeedbackForm()}),this.registered=!0))}c.prototype.showFeedbackForm=function(b){this.hideThankYou();this.A.trigger("vse:"+this.id+":feedback:shown");
return this};c.prototype.hideFeedbackForm=function(){this.isMobile?this.getAndSetBottomSheetInstance()&&this.bottomSheetInstance.hide():this.getAndSetPopoverInstance()&&this.popoverInstance.hide();this.A.trigger("vse:"+this.id+":feedback:hidden");return this};c.prototype.setActiveVideoAndSource=function(b,a){this.activeVideo=b;this.activeVideoSource=a};c.prototype.submitFeedback=function(){var b={events:[{data:{feedback:{playerVersion:"",asin:this.pageAsin,videoId:this.activeVideo,videoSource:this.activeVideoSource,
url:document.location.href,userAgent:g.navigator&&g.navigator.userAgent?g.navigator.userAgent:"window.navigator.userAgent not supported",feedbackTime:this.A.now(),customerId:this.customerId,feedbackWidgetVersion:"2",marketplace:this.marketplaceId,placement:this.pageStateName}}}]};this.A.$.ajax({url:this.endpoint,data:JSON.stringify(b),type:"POST",contentType:"application/json; charset\x3dutf-8",error:this._submitErrorCallback,success:this._submitSuccessCallback});this.A.trigger("vse:"+this.id+":feedback:submitted");
this.showThankYou()};c.prototype.closeFeedbackForm=function(){this.hideFeedbackForm();this.A.trigger("vse:"+this.id+":feedback:closed")};c.prototype.showThankYou=function(){this.feedbackForm.fadeOut(200);this.thankYouSection.removeClass("aok-hidden").fadeIn(400);this.A.trigger("vse:"+this.id+":thank-you:shown");return this};c.prototype.hideThankYou=function(){this.feedbackForm.fadeIn(10);this.thankYouSection.addClass("aok-hidden").fadeOut(10);this.A.trigger("vse:"+this.id+":thank-you:hidden");return this};
c.prototype.validateFormElements=function(){return this.thankYouSection.length&&this.submitButton.size()&&this.feedbackForm.length};c.prototype.getAndSetBottomSheetInstance=function(){return this.bottomSheetFactory?this.bottomSheetInstance?this.bottomSheetInstance:this.bottomSheetInstance=this.bottomSheetFactory.get(this.id+"-sheet"):u};c.prototype.getAndSetPopoverInstance=function(){return this.popoverFactory?this.popoverInstance?this.popoverInstance:this.popoverInstance=this.popoverFactory.get(this.id+
"-popover"):u};return c}(),Z=function(){function c(b){this.config=b;this.feedbackWidgets={}}c.prototype.create=function(b,a){a=this.feedbackWidgets[b]||new Y({id:b,pageStateName:a,A:this.config.A,buttonApi:this.config.buttonApi});return this.feedbackWidgets[b]=a};c.prototype.get=function(b){return this.feedbackWidgets[b]};return c}(),k=function(){function c(){}c.POSITIVE_VOTE="positive";c.NEGATIVE_VOTE="negative";c.NONE_VOTE="none";c.EMPTY_STRING="";c.DEFAULT_MIN_GUTTER=24;c.DEFAULT_HEIGHT_ANIMATION_SPEED=
200;c.CAROUSEL_PREV_BUTTON_CLASS=".a-carousel-goto-prevpage";c.CAROUSEL_NEXT_BUTTON_CLASS=".a-carousel-goto-nextpage";c.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASSHIDDEN_CLASS="aok-hidden";c.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS="vse-carousel-goto-deactive-btn";c.ANIMATION_SPEED_400=400;c.ANIMATION_SPEED_100=100;c.BOUNCE_CAROUSEL_FACTOR=30;c.BOUNCE_SCROLL_BAR_FACTOR=6;c.SWING="swing";c.FIRST_PAGE="first-page";c.LAST_PAGE="last-page";c.$GROUP_1=".segment-title-G1";c.$GROUP_2=".segment-title-G2";c.NO_GUTTER=
0;c.TOLERANT=-.5;c.CURRENT_GUTTER="currentGutter";c.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY=1;c.VIP_CAROUSEL_CSS_CLASS="vse-vip-lb-carousel";return c}(),D=function(){function c(b,a){this.element=b;this.videoVoteConfig=a;this.countsFetched=!1;this.positiveVoteCount=0;this.showPositiveVotes=!1;this.negativeVoteCount=0;this.showNegativeVotes=!1;this.prompt=b.find(".vse-vote-helpful-text");this.positiveVoteText=b.find(".vse-vote-positive");this.positiveVoteIcon=b.find(".vse-vote-positive-icon");this.negativeVoteText=
b.find(".vse-vote-negative");this.negativeVoteIcon=b.find(".vse-vote-negative-icon");this.previousVote=k.EMPTY_STRING}c.prototype.getVoteCount=function(b){return b===k.POSITIVE_VOTE?this.positiveVoteCount:b===k.NEGATIVE_VOTE?this.negativeVoteCount:0};c.prototype.setVoteCount=function(b,a){0>a&&(a=0);b===k.POSITIVE_VOTE?(this.positiveVoteCount=a,this.positiveVoteText.html(String(a))):b===k.NEGATIVE_VOTE&&(this.negativeVoteCount=a,this.negativeVoteText.html(String(a)));this.element.addClass("updated")};
c.prototype.getPreviousVote=function(){return this.previousVote};c.prototype.setPreviousVote=function(b){if(b===k.POSITIVE_VOTE)this.positiveVoteIcon.addClass("hasvoted"),this.negativeVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(k.POSITIVE_VOTE)&&this.setVoteCount(k.POSITIVE_VOTE,1);else if(b===k.NEGATIVE_VOTE)this.negativeVoteIcon.addClass("hasvoted"),this.positiveVoteIcon.removeClass("hasvoted"),0>=this.getVoteCount(k.NEGATIVE_VOTE)&&this.setVoteCount(k.NEGATIVE_VOTE,1);else if(b===k.NONE_VOTE)this.negativeVoteIcon.removeClass("hasvoted"),
this.positiveVoteIcon.removeClass("hasvoted");else return;this.previousVote=b};c.prototype.setContentId=function(b){this.contentId=b};c.prototype.getContentId=function(){return this.contentId};c.prototype.showOrHide=function(b,a,d,c){this.showPositiveVotes=b;this.showNegativeVotes=a;this.showPrompt=d;b?(this.positiveVoteText.addClass("show"),this.positiveVoteIcon.addClass("show")):(this.positiveVoteText.removeClass("show"),this.positiveVoteIcon.removeClass("show"));a?(this.negativeVoteText.addClass("show"),
this.negativeVoteIcon.addClass("show")):(this.negativeVoteText.removeClass("show"),this.negativeVoteIcon.removeClass("show"));d?this.prompt.addClass("show"):this.prompt.removeClass("show");c?this.element.addClass("show"):this.element.removeClass("show")};c.prototype.updateWithNewVote=function(b){if(b===k.POSITIVE_VOTE||b===k.NEGATIVE_VOTE){var a=b==k.POSITIVE_VOTE?k.NEGATIVE_VOTE:k.POSITIVE_VOTE,d=this.getVoteCount(b),c=this.getVoteCount(a);b===this.getPreviousVote()?(this.setPreviousVote(k.NONE_VOTE),
this.setVoteCount(b,d-1)):this.getPreviousVote()!==k.EMPTY_STRING&&this.getPreviousVote()!==k.NONE_VOTE?(this.setVoteCount(a,c-1),this.setVoteCount(b,d+1),this.setPreviousVote(b)):(this.setPreviousVote(b),this.setVoteCount(b,d+1))}};return c}(),aa=function(){return function(c,b,a){this.contentId=c;this.positiveVoteCount=b;this.negativeVoteCount=a}}(),R=function(){function c(b,a){this.A=b;this.videoVoteConfig=a}c.prototype.createFromContent=function(b,a){b=this.A.$("#"+b).find('[.vse-video-votes][data-contentid\x3d"'+
a+'"]');return new D(b,this.videoVoteConfig)};c.prototype.createFromSelector=function(b){var a=this.A.$(""+b);if(!a)throw new E("VideoVoteContainerFactory can not find selector by the name of "+b+".");return new D(a,this.videoVoteConfig)};c.prototype.sendVoteToRemote=function(b,a,d){var c=this,f=this.getBasicPayload(this.videoVoteConfig),t=this.A.$.extend(f,{contentId:d,positive:b,negative:a});return new this.videoVoteConfig.dependencies.promise(function(a,d){y.sendRequest(c.A,"/vap/ew/subcomponent/votes/writing",
t,function(d){a(d)},function(a){l.count("vse:votecast:failed",1);d(a)})})};c.prototype.fetchVoteHistory=function(b){var a=this,d=this.getBasicPayload(this.videoVoteConfig),c=this.A.$.extend(d,{contentId:b});return new this.videoVoteConfig.dependencies.promise(function(d,b){y.sendRequest(a.A,"/vap/ew/subcomponent/votes/status",c,function(a){d(a)},function(a){l.count("vse:votehistory:failed",1);b(a)})})};c.prototype.convertPayloadToVoteData=function(b){var a=[],d;for(d in b)b.hasOwnProperty(d)&&a.push(new aa(d,
b[d].positive,b[d].negative));return a};c.prototype.fetchVoteCounts=function(b){var a=this,d=this.getBasicPayload(this.videoVoteConfig),c=this.A.$.extend(d,{contentIds:b});return new this.videoVoteConfig.dependencies.promise(function(d,b){y.sendRequest(a.A,"/vap/ew/subcomponent/votes",c,function(c){c=a.convertPayloadToVoteData(c);0<c.length&&d(c);b(c)},function(a){l.count("vse:votegetcounts:failed",1);b(a)})})};c.prototype.getBasicPayload=function(b){return{placement:b.placementContext,requestId:b.requestId,
sessionId:b.sessionId,page:b.page,bypassLogin:b.forceTreatment||!1}};return c}(),S=function(){function c(b){this.config=b;this.additionalPaddingTop=0;this.$stickies=null;this.$container=this.config.A.$(this.config.stickyHeaderContainer);this.$lbContainer=this.config.A.$(this.config.stickyHeaderLBContainer);this.lbModalContainer=this.config.lbModalContainer;this.gutter=this.$container.offset().top;this.topPosition=this.$container.offset().top-this.$lbContainer.closest(this.lbModalContainer).offset().top}
c.prototype.load=function(b){if("object"===typeof b&&0<b.length){var a=this;this.$stickies=b.each(function(d){d=a.config.A.$(this).parents(".vse-follow-wrap").length?a.config.A.$(this):a.config.A.$(this).wrap('\x3cdiv class\x3d"vse-follow-wrap" /\x3e');if(!a.config.A.objectIsEmpty(a.$lbContainer.data("css-class"))){var b=-1!==a.$lbContainer.data("css-class").indexOf("vse-lb-v2");a.additionalPaddingTop=b?parseInt(d.css("padding-top")):0}d.data("originalPosition",d.offset().top+a.$container.scrollTop()-
a.gutter-a.additionalPaddingTop).data("originalHeight",d.outerHeight()).parent().height(d.outerHeight(!0))});this.$container.unbind("scroll");this.$container.bind("scroll",function(){a._whenScrolling()});this.$container.scroll()}};c.prototype._whenScrolling=function(){var b=this;this.$stickies.each(function(a){a=b.config.A.$(this);var d=a.data("originalPosition"),c=b.$container.scrollTop();d<=c?a.addClass("vse-absolute").css({top:c}):a.removeClass("vse-absolute").removeAttr("style")})};return c}(),
ba=function(){return function(c){var b=this;this.config=c;this.getTabs=function(){return b.tabs};this.updateSegmentTabForVideo=function(a){b.config.A.$(""+b.segmentTabCssClassSelectorName).removeClass("vse-tab-active vse-tab-no-border");for(var d=0;d<b.tabs.length&&a>=b.tabs[d].startIndex;++d);b.config.A.$(b.segmentTabCssClassSelectorName+".tab-"+(0<d?d-1:0)).addClass("vse-tab-active vse-tab-with-border")};this.updateSegmentTabOnClick=function(a){b.config.A.$(""+b.segmentTabCssClassSelectorName).removeClass("vse-tab-with-border").addClass("vse-tab-no-border");
b.config.A.$(b.segmentTabCssClassSelectorName+"."+a.cssClassName).addClass("vse-tab-with-border")};this.tabs=c.segmentTabs||[];this.segmentTabCssClassSelectorName=this.config.segmentTabCssClassSelectorName}}(),ca=function(){function c(b,a,d,c,f,t){var h=this;this.carouselFramework=a;this.carouselConstants=d;this.A=c;this.contentCarouselConfig=f;this.deps=t;this.vseAssets=[];this.vseAssetIndex={};this.voteContainerIndex={};this.carouselPageSize=this.carouselTotalPages=0;this.carouselPageNumber=1;this.loadImagesManually=
function(a,d){for(var b=a.getAttr(h.carouselConstants.PAGE_SIZE),c=d=(d-1)*b+1;c<d+b+k.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY;c++){var f=h.A.$(a.dom.$container.find(".vse-video-card:nth-child("+c+")"));f.addClass("vse-img-manually-loaded");h.A.loadDescendantImagesManually(f)}};this.getplaylist=function(){return h.vseAssets.slice()};this.getActiveAsset=function(){return h.activeAsset};this.scrollTo=function(){if(h.contentCarouselConfig.hasStickyHeaders){var a=h.A.$("#"+h.contentCarouselConfig.carouselName).closest(".vse-lb-right"),
d=0;0===h.activeCard.find(".vse-vc-header.first-item").length&&(d=h.A.$(".vse-follow-wrap").first().height()-2);a.animate({scrollTop:h.activeCard.offset().top-a.offset().top+a.scrollTop()-d})}else h.A.$("#"+h.contentCarouselConfig.carouselName).animate({scrollTop:h.activeCard.offset().top-h.A.$("#"+h.contentCarouselConfig.carouselName).offset().top+h.A.$("#"+h.contentCarouselConfig.carouselName).scrollTop()})};this.rotateTo=function(a){h.useMultiCarousel?h.rotateToMultiCarousel(a):(h.markPlaying(a),
h.contentCarouselConfig.isVerticalScroll&&h.scrollTo(),0!==h.carouselPageSize&&(a=h.findIndex(a),-1!==a&&(a=Math.floor(a/h.carouselPageSize)+1,h.carouselPageNumber!=a&&("none"==h.auiCarousel.getAttr("transitionStrategy")?h.animateCarousel(a-1):h.auiCarousel.gotoPage(a)))))};this.rotateToMultiCarousel=function(a){h.markPlaying(a);0===h.carouselPageSize&&(h.carouselPageSize=1);a=h.findIndex(a);-1!==a&&(a=(a+1<h.vseAssets.length?a+1:a)+1,h.carouselPageNumber!=a&&("none"==h.auiCarousel.getAttr("transitionStrategy")?
h.animateCarousel(a-1):h.auiCarousel.gotoPage(a)))};this.markPlaying=function(a){h.activeAsset=a;h.activeCard.removeClass("active");h.activeCard=h.vseAssetIndex[a.contentId].$el.closest("li").addClass("active")};this.findIndex=function(a){return h.vseAssets.indexOf(h.vseAssetIndex[a.contentId])};this.emitRefTag=function(a,d,b){0<h.listOffset&&(a=(a-h.listOffset+h.vseAssets.length)%h.vseAssets.length);h.refTagRecorder.emitRefTag(d+a+b)};this.destroy=function(){h.A.$("#"+h.contentCarouselConfig.carouselName+
" .a-carousel-card.active").removeClass("active")};this.updateVotingElements=function(a,d){h.A.each(a,function(a){var b=h.vseAssetIndex[a.contentId].videoVoteContainer;b.setVoteCount(k.POSITIVE_VOTE,a.positiveVoteCount);b.setVoteCount(k.NEGATIVE_VOTE,a.negativeVoteCount);b.countsFetched=!0;b.showOrHide(d,d,!1,d)})};this.attachStickyHeader=function(a){h.stickyHeaders=new S(a);h.stickyHeaders.load(h.A.$(a.stickyHeaderContainer+" .vse-vc-header.first-item"))};this.initializeSegmentTabs=function(a){h.segmentTabsModule=
new ba(a);h.segmentTabs=h.segmentTabsModule.getTabs();h.attachTabClickHandlers();h.attachTabChangeHandlerOnCarouselScroll();h.showCustomerProfiles()};this.showCustomerProfiles=function(){var a="#"+h.contentCarouselConfig.carouselName+"."+k.VIP_CAROUSEL_CSS_CLASS+" .vse-video-card";h.A.$(a).each(function(a,d){a=h.A.$(d).find(".vse-video-customer-profile");d=h.A.$(d).find(".vse-video-labels");0<a.length&&0<d.length&&d.html(a.removeClass("aok-hidden").detach().get(0).outerHTML)});h.A.$(a+" .vse-profile").click(function(a){a.stopPropagation();
a.stopImmediatePropagation()})};this.attachTabClickHandlers=function(){h.segmentTabs.forEach(function(a){var d=h.A.$(h.segmentTabsModule.segmentTabCssClassSelectorName+"."+a.cssClassName);d.click(function(){h.animateCarousel(a.startIndex);d.hasClass("vse-tab-active")||h.segmentTabsModule.updateSegmentTabOnClick(a)})})};this.attachTabChangeHandlerOnCarouselScroll=function(){h.A.$("#"+h.contentCarouselConfig.carouselName+"."+k.VIP_CAROUSEL_CSS_CLASS+" .a-carousel-viewport").scroll(function(){h.A.$("#"+
h.contentCarouselConfig.carouselName+"."+k.VIP_CAROUSEL_CSS_CLASS+" .vse-video-card").each(function(a,d){h.orientationConfig.getCardInViewOffset(h.A.$(d))<=h.orientationConfig.getOffsetPointForTabUpdate()&&h.segmentTabsModule.updateSegmentTabForVideo(a)})})};this.animateCarousel=function(a){h.A.objectIsEmpty(h.orientationConfig)||(a*=h.orientationConfig.animatedCarouselDimensionValue(),h.useMultiCarousel&&h.resizeCarousel(a),h.auiCarousel.dom.$viewport.animate(h.orientationConfig.getCarouselPropertyToAnimate(a),
500))};this.resizeCarousel=function(a){var d=h.auiCarousel.dom.$viewport[0].scrollWidth-h.auiCarousel.dom.$viewport[0].clientWidth;if(d<a){var b=h.auiCarousel.dom.$carousel.css("width").slice(0,-2);h.auiCarousel.dom.$carousel.css("width",parseInt(b)+(a-d)+"px")}};this.scrollToActiveVideo=function(a){a=h.findIndex(a);h.animateCarousel(a)};this.updateSegmentTabForActiveVideo=function(a){a=h.findIndex(a);h.segmentTabsModule.updateSegmentTabForVideo(a)};this.setOrientationConfig=function(a){h.orientationConfig=
a};this.getAssetSpec=function(a,d,b,c){var f=a.data(),r=a.find(".vse-video-image").data("img"),r=r.replace("SR160,90_BG0,0,0_PKvse-overlay-play2","").replace("SR320,180_BG0,0,0_PKvse-overlay-play2",""),H=[];if(f.closedCaptions)for(var n=f.closedCaptions.split(","),g=0;g<n.length-1;g+=2)H.push({locale:n[g],url:n[g+1]});return{index:d,contentId:a.attr("data-asin"),title:f.title,vendorName:f.vendorName,vendorCode:f.vendorCode,referenceUrl:f.referenceUrl,referenceLinkTitle:f.referenceTitle,videoUrl:f.videoUrl,
$el:a,duration:f.duration,imageUrl:r,sponsored:f.sponsored,videoVoteContainer:h.voteContainerIndex[f.asin],productAsin:f.productAsin,refTag:b+d+c,continuousPlayRefTag:b+d+c+"_auto_play",relatedProducts:f.relatedProducts,vendorTrackingId:f.vendorTrackingId,videoReferenceId:f.videoRefId,groupType:f.groupType,impressionRecorded:!1,closedCaptions:H,creatorType:f.creatorType}};this.displayOrHideCarouselButtons=function(a){var d=a.getAttr(h.carouselConstants.PAGE_NUMBER),b=a.getAttr(h.carouselConstants.TOTAL_PAGES),
c=a.dom.$container.find(k.CAROUSEL_PREV_BUTTON_CLASS);a=a.dom.$container.find(k.CAROUSEL_NEXT_BUTTON_CLASS);c.toggleClass(k.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS,1===d||1===b);a.toggleClass(k.VSE_CAROUSEL_PAGINATION_DEACTIVATE_CLASS,d===b||1===b)};this.removeActive=function(){h.activeAsset=u;h.activeCard.removeClass("active")};var n=c.$;this.activeCard=n([]);var g=this;this.auiCarousel=b;this.refTagRecorder=new B(c);this.useMultiCarousel=f.useMultiCarousel;n("#"+f.carouselName).find(".a-carousel-heading").after(n("#"+
f.carouselName).find(".vse-upload-link").removeClass("aok-hidden"));n("#"+f.carouselName+" .vse-video-item").each(function(a){a=g.getAssetSpec(n(this),a,g.contentCarouselConfig.refTagPrefix,g.contentCarouselConfig.celQueryStringParam);g.vseAssets.push(a);g.vseAssetIndex[a.contentId]=a});f.showVideoVotes&&f.videoVoteConfig&&(this.videoVoteContainerFactory=new R(c,f.videoVoteConfig),c.each(this.vseAssetIndex,function(a){h.voteContainerIndex[a.contentId]=h.videoVoteContainerFactory.createFromContent(h.contentCarouselConfig.carouselName,
a.contentId);a.videoVoteContainer=h.voteContainerIndex[a.contentId]}));n("#"+f.carouselName+" .vse-video-card").find(k.$GROUP_1).first().addClass("first-item");n("#"+f.carouselName+" .vse-video-card").find(k.$GROUP_2).first().addClass("first-item");n("#"+f.carouselName).delegate(".a-carousel-card a","click",function(a){if(n(this).closest("li").hasClass("active"))a.preventDefault();else{var d=g.vseAssetIndex[n(this).closest("li").find(".vse-video-item").data("asin")];g.markPlaying(d);d.eventTimestamp=
Date.now();c.trigger("vse:contentCarousel:"+f.carouselName+":click",d);d=g.findIndex(d);g.emitRefTag(d,g.contentCarouselConfig.refTagPrefix,g.contentCarouselConfig.celQueryStringParam);f.isPreventDefault&&a.preventDefault()}});n("#"+f.carouselName+" .vse-carousel-item").each(function(a){var d=n(this);d.attr("href",d.data("redirect-url")+"?ref\x3d"+g.contentCarouselConfig.refTagPrefix+a+g.contentCarouselConfig.celQueryStringParam)});c.off("a:carousel:"+f.carouselName+":change:pageSize");c.off("a:carousel:"+
f.carouselName+":change:pageNumber");c.on("a:carousel:"+f.carouselName+":change:pageSize",function(){h.carouselPageSize=h.auiCarousel.getAttr("pageSize");h.activeAsset&&h.rotateTo(h.activeAsset)});c.trigger("a:carousel:"+f.carouselName+":change:pageSize");c.on("a:carousel:"+f.carouselName+":change:pageNumber",function(a){a.carousel.getAttr("totalPages");h.carouselPageNumber=h.auiCarousel.getAttr("pageNumber");c.trigger("a:carousel:"+f.carouselName+":scrollCarousel",h.carouselPageNumber,h.carouselPageSize)});
c.trigger("a:carousel:"+f.carouselName+":updatePageIndex",this.carouselPageNumber,this.carouselPageSize);c.declarative(f.carouselName+"-sm-link","click touch",function(a){n("#"+f.carouselName+" .vse-video-item .vse-carousel-item").first().click()});this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(a){h.contentCarouselConfig.useCustomButtons&&(c.declarative.create(c.$("#"+f.carouselName),h.contentCarouselConfig.carouselName+"-declarative",{}),c.declarative(h.contentCarouselConfig.carouselName+
"-declarative","mouseenter touchstart focus",function(){1!==a.getAttr(h.carouselConstants.TOTAL_PAGES)&&(c.$("#"+f.carouselName).addClass("vse-carousel-show-btn"),c.$("#"+f.carouselName+" .vse-carousel-button").stop(!0,!0).fadeIn({duration:300,queue:!1}))}),c.declarative(h.contentCarouselConfig.carouselName+"-declarative","mouseleave",function(){1!==a.getAttr(h.carouselConstants.TOTAL_PAGES)&&(c.$("#"+f.carouselName).removeClass("vse-carousel-show-btn"),c.$("#"+f.carouselName+" .vse-carousel-button").stop(!0,
!0).fadeOut({duration:300,queue:!1}))}),h.displayOrHideCarouselButtons(a));h.contentCarouselConfig.loadImagesManually&&h.loadImagesManually(a,1);c.on("a:carousel:"+h.contentCarouselConfig.carouselName+":change:pageNumber",function(a){h.contentCarouselConfig.loadImagesManually&&(h.displayOrHideCarouselButtons(a.carousel),h.loadImagesManually(a.carousel,a.newValue))});c.on("a:carousel:"+h.contentCarouselConfig.carouselName+":change:pageSize",function(a){h.contentCarouselConfig.loadImagesManually&&(h.displayOrHideCarouselButtons(a.carousel),
h.loadImagesManually(a.carousel,a.newValue))});h.useMultiCarousel&&h.activeAsset&&h.rotateToMultiCarousel(h.activeAsset)})}c.prototype.changeStartingCardTo=function(b){var a=this;this.listOffset=this.findIndex(b);var d=this;this.A.$("#"+this.contentCarouselConfig.carouselName+" .vse-carousel-item").each(function(a){var b=d.A.$(this);a=(a-d.listOffset+d.vseAssets.length)%d.vseAssets.length;b.attr("href",b.data("redirect-url")+"?ref\x3d"+d.contentCarouselConfig.refTagPrefix+a)});this.contentCarouselConfig.isVerticalScroll||
(this.carouselFramework.initializeAll(),this.carouselFramework.onInit(""+this.contentCarouselConfig.carouselName,function(){a.rotateTo(b)}))};return c}(),G=function(){function c(b,a,d,c){this.carouselFramework=b;this.carouselConstants=a;this.A=d;this.deps=c}c.prototype.create=function(b){var a=this.carouselFramework.getCarousel(this.A.$("#"+b.carouselName));if(!a)throw new E("Carousel framework can not find carousel by the name of "+b.carouselName+".");return new ca(a,this.carouselFramework,this.carouselConstants,
this.A,b,this.deps)};return c}(),T=function(){function c(b,a){var d=this;this.A=b;this.constants=a;this.repaint=function(a){var b=a.getDimensions().viewport.width,c=a.dom.$carousel.children("li").get(0).getBoundingClientRect(),c=c.width?c.width:c.right-c.left,f=d.updateVisibleItems(a,b,c);d.updateCarouselDimensions(a,b,c);a.gotoIndex(f,{animationDuration:0,ignorePause:!0});a.triggerEvent("repaint")};this.resize=function(a,b){b.viewport&&b.viewport.width!==u&&d.repaint(a)};this.init=function(a){var b=
a.getAttr(d.constants.FIRST_VISIBLE_ITEM);a.setAttr(d.constants.MIN_GUTTER,k.NO_GUTTER);a.setAttr(k.CURRENT_GUTTER,k.NO_GUTTER);d.repaint(a);1<b&&(b=Math.ceil(b/a.getAttr(d.constants.PAGE_SIZE)),a.gotoPage(b));d.bindAttrChangeHandlers(a)}}c.prototype.determinePageSize=function(b,a,d){b=0;if(0<d)for(;a>k.TOLERANT;)b++,a-=d;0>a&&b--;return this.A.isFiniteNumber(b)&&0<b?b:1};c.prototype.bindAttrChangeHandlers=function(b){var a=this;b.onChange(this.constants.PAGE_NUMBER,function(){b.getAttr(a.constants.HIDE_OFF_SCREEN)&&
b.dom.$carousel.children("li").css("visibility","")});b.onChange(this.constants.ANIMATING,function(d){if(!d&&b.getAttr(a.constants.HIDE_OFF_SCREEN)){var c=b.getAttr(a.constants.FIRST_VISIBLE_ITEM)-1,f=c+b.getAttr(a.constants.PAGE_SIZE)-1;b.dom.$carousel.children("li").each(function(d,b){d=d>=c&&d<=f;a.A.$(b).css("visibility",d?"":"hidden")})}})};c.prototype.updateCarouselDimensions=function(b,a,d){var c;c=b.dom.$carousel;var f=c.children("li");a=f.length;var g=f.first().outerWidth(!0),f=f.eq(1).outerWidth(!0),
g=(a-1)*f+g;c.css("width",g+"px");g={carousel:{width:g,outerWidth:c.outerWidth()},items:[]};for(c=0;c<a;c++)g.items.push({width:d,outerWidth:f});b.updateDimensionsCache(g)};c.prototype.updateVisibleItems=function(b,a,d){var c=b.getAttr(this.constants.TOTAL_PAGES),f=b.getAttr(this.constants.PAGE_NUMBER),g=b.getAttr(this.constants.HIDE_OFF_SCREEN),h=b.dom.$carousel.children("li"),n=b.getAttr(this.constants.FIRST_VISIBLE_ITEM);a=this.determinePageSize(b,a,d);var l=(f-1)*a+1;b.setAttr(this.constants.PAGE_SIZE,
a);f>c?(n=(c-1)*a+1,b.setAttr(this.constants.PAGE_NUMBER,c),b.setAttr(this.constants.FIRST_VISIBLE_ITEM,n)):n!==l&&(c=Math.ceil(n/a),n=(c-1)*a+1,b.setAttr(this.constants.PAGE_NUMBER,c),b.setAttr(this.constants.FIRST_VISIBLE_ITEM,n));var e=n-1,x=e+a-1;h.each(function(a,b){b.style.visibility=!g||a>=e&&a<=x+k.NUMBER_OF_CARDS_TO_LOAD_ADDITIONALLY?"":"hidden";b.style.width=d+"px"});return n};return c}(),U=function(){function c(b,a,d){var c=this;this.A=b;this.constants=a;this.slideTransition=d;this.carouselLeft=
0;this.token=!1;this.init=function(a){c.$scrollBar=a.dom.$container.find(".vse-carousel-scrollbar-thumb");c.carouselLeft=-1*parseInt(a.dom.$carousel.css("left"),10);c.slideTransition.init(a)};this.gotoNextPage=function(a,d){return c.slideTransition.gotoNextPage(a,d)};this.gotoPrevPage=function(a,d){return c.slideTransition.gotoPrevPage(a,d)};this.gotoPage=function(a,d,b){if(!c.locked()){c.lock();var f=d,g=a.getAttr(c.constants.TOTAL_PAGES),e=a.getAttr(c.constants.PAGE_SIZE),l=a.getAttr(c.constants.SET_SIZE);
0<d&&d<=g&&a.setAttr(c.constants.PAGE_NUMBER,d);1>d?d=1:d>g&&(d=g);var m=e*(d-1)+1;d===g&&(m=Math.min(m,l-e+1));1>f||f>g?(c.bounce(a.dom.$carousel,k.BOUNCE_CAROUSEL_FACTOR*(1>f?1:-1)),c.bounce(c.$scrollBar,1*k.BOUNCE_SCROLL_BAR_FACTOR)):c.gotoIndex(a,m,b)}};this.gotoIndex=function(a,d,b){var f=a.getDimensions();b=f.carousel.outerWidth;var f=f.viewport.outerWidth,g=b-f;d=Math.max(Math.min(a.getItemOffset(d),g),0);b=f/b;f=Math.min(b*f,f);c.$scrollBar=a.dom.$container.find(".vse-carousel-scrollbar-thumb");
c.$scrollBar.width(f);c.$scrollBar.animate({left:b*d},k.ANIMATION_SPEED_400,k.SWING);a.dom.$carousel.animate({left:-d},k.ANIMATION_SPEED_400,k.SWING,function(){c.carouselLeft=a.dom.$carousel.css("left");c.unlock()})};this.lock=function(){c.token=!0};this.unlock=function(){c.token=!1};this.locked=function(){return c.token};this.vseTransitionStrategy=b.copy(d);this.vseTransitionStrategy.init=function(a){return c.init(a)};this.vseTransitionStrategy.gotoPage=function(a,d,b){return c.gotoPage(a,d,b)};
this.vseTransitionStrategy.gotoIndex=function(a,d,b){return c.gotoIndex(a,d,b)}}c.prototype.get=function(){return this.vseTransitionStrategy};c.prototype.bounce=function(b,a){var d=this;b.each(function(b,c){var f=d.A.$(c);f.animate({marginLeft:a},k.ANIMATION_SPEED_400,k.SWING,function(){f.animate({marginLeft:0},k.ANIMATION_SPEED_100,k.SWING,d.unlock)})})};return c}(),da={BrilaFactory:N,VSEPlayer:K,BrilaShim:L,PlayerPromiseShim:M,GatedP:z,PostMetric:l,AuiUtils:w,EventEmitter:F,VideoVoteContainer:D,
ContentCarouselFactory:G,InvalidArgumentsException:E,guid:v,StickyHeaders:S,RefTagRecorder:B,VSEDisplayStrategy:T,VSETransitionStrategy:U},f=function(){function c(){}c.PLAYER_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-player-failed-to-render-no-pagestate";c.LAZY_LOAD_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-lazyload-failed-to-render-no-pagestate";c.RV_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-rv-failed-to-render-no-pagestate";c.INGRESS_RV_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-ingress-failed-to-render-no-pagestate";c.FEEDBACK_PAGE_STATE_NOT_FOUND_ERROR_KEY=
"vse-feedback-failed-to-render-no-pagestate";c.METADATA_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-metadata-failed-to-render-no-pagestate";c.SOCIAL_SHARE_STATE_NOT_FOUND_ERROR_KEY="vse-social-share-failed-to-render-no-pagestate";c.RELATED_PRODUCT_PAGE_STATE_NOT_FOUND_ERROR_KEY="vse-related-product-failed-to-render-no-pagestate";c.LB_POPOVER_NOT_FOUND_ERROR_KEY="vse-lb-failed-to-render-no-popover";c.VISIBLE_DIV_NARROW_PREFIX="vse-pc-visible-narrow-";c.AJAX_MAX_RETRY_COUNT=3;c.VAP_EW="/vap/ew/";c.RELATED_PRODUCTS_ENDPOINT=
"subcomponent/relatedproducts/";c.EMPTY_STRING="";c.PORTRAIT="portrait";c.LANDSCAPE="landscape";c.SQUARE="square";c.PORTRAIT_ASPECT_RATIO="9:16";c.LANDSCAPE_ASPECT_RATIO="16:9";c.SQUARE_ASPECT_RATIO="1:1";c.IS_VIDEO_IMMERSIVE_PLAYER_KEY="isVideoImmersivePlayer";c.SHOW_CONTENT_CAROUSEL="showContentCarousel";c.COMMA=",";c.SEMICOLON=";";c.INGRESS_CAROUSEL_SUFFIX="-vse-related-videos";c.videoInformationContainer=".vse-lb-video-metadata";c.videoTitle=c.videoInformationContainer+" .vse-content-title";c.vendorName=
c.videoInformationContainer+" .vse-video-author";c.ibVideoOspDisclosure=c.videoInformationContainer+" .vse-oap-disclosure-container";c.ibVideoAiDisclosure=c.videoInformationContainer+" .vse-aip-disclosure-container";c.socialShareClickMetricName="vseSocialShareClickImageBlock";c.RELATED_PRODUCTS_INNER_CONTAINER=".vse-rp-container";c.RELATED_PRODUCTS_INNER_CLASS_NAME="vse-rp-container";c.CACHE_RP_PAYLOAD_HIDDEN_DIV_CONTAINER=".vse-related-products-cache-hidden";c.RELATED_PRODUCTS_CONTAINER_SELECTOR=
".vse-related-products-narrow";c.RELATED_PRODUCTS_ITEM_SELECTOR=".vse-product-item";c.ATTRIBUTION_NAME="vse-component-assets";c.LB_CAROUSEL_CONFIG='div[class^\x3d"div-"][class$\x3d"-vip-relatedvideos"]';c.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME="vse-close-button-on-player";c.TALET_LIGHTBOX_CLASS_NAME="vse-tablet-popover";c.AUI_POPOVER_INNER=".a-popover-inner";c.VIPLightboxSelector=".vse-vip-lightbox";c.LightboxWrapperSelector=".vse-lightbox-wrapper";c.VIPOverlaySelector=".vse-vip-overlay";c.VIPActionOverlaySelector=
".vse-vip-actions-overlay";c.VIPLbTabsAndCarouselOverlaySelector=".vse-vip-lb-tabs-carousel-container-overlay";c.VIPLbCarouselSelector=".vse-vip-lb-carousel-container";c.VIPProductCarouselOverlaySelector=".vse-pc-container-overlay";c.VIPLbTabsAndCarouselContainerSelector=".vse-vip-lb-tabs-carousel-container";c.VIPProductCarouselOverlayContainerSelector=".vse-pc-container";c.VIPShopIconSelector=".vse-vip-shop-icon";c.VIPWatchIconSelector=".vse-vip-watch-icon";c.VIPWatchIconBlockSelector=".vse-vip-watch";
c.VIPShareIconSelector=".vse-vip-share-icon";c.VIPActionIconSelector=".vse-vip-action-icon";c.VIPEmptyRelatedProductsContainerSelector=".vse-related-products-mobile-empty";c.VIPLbTabsContainerSelector=".vse-vip-lb-tabs";c.VIPLbCarouselViewportSelector=".vse-vip-lb-carousel .a-carousel-viewport";c.VIPSkipBackButtonSelector=".vse-vip-skip-backward-button";c.VIPSkipForwardButtonSelector=".vse-vip-skip-forward-button";c.VIPPlayPauseToggleSelector=".vse-vip-play-pause-toggle";c.VIPProgressBarSelector=
".vse-vip-scrubber-bar";c.VIPProgressBarFillSelector=".vse-vip-scrubber-bar-fill";c.VIPTimeElapsedSelector=".vse-vip-time-elapsed-display";c.VIPTimeRemainingSelector=".vse-vip-time-remaining-display";c.VIPProductCarouselViewportSelector=".vse-pc-container .a-carousel-viewport";c.VIPCCButtonSelector=".vse-vip-custom-cc-button";c.VIPCCTooltipSelector=".vse-vip-cc-tooltip";c.VIPCCTooltipTextSelector=".vse-vip-cc-tooltip-text";c.defaultPlayerCCButtonTitleSelector=".vjs-subs-caps-button.vjs-menu-button \x3e button";
c.VIPFeedbackContainer=".vse-fb-trigger-container";c.VIPMultiCarouselWrapper=".vse-vip-lb-multi-carousel-container-wrapper";c.VIPMultiCarouselOverlay=".vse-vip-lb-multi-carousel-container-overlay";c.VIPMultiCarouselOneContainer=".vse-vip-lb-first-carousel-container";c.VIPMultiCarouselTwoContainer=".vse-vip-lb-second-carousel-container";c.VIPMultiCarouselOneCarousel=".vse-vip-lb-first-carousel-container .a-carousel-viewport";c.VIPMultiCarouselTwoCarousel=".vse-vip-lb-second-carousel-container .a-carousel-viewport";
c.VIPMultiCarouselExpandedClass="vse-vip-multi-carousel-expanded";c.G1="G1";c.G2="G2";c.VIPPlayIconClassName="vse-vip-play-icon";c.VIPPauseIconClassName="vse-vip-pause-icon";c.VIPLbOverlayShowCssClassName="vse-lb-tabs-overlay-show";c.VIPOverlayShowClassName="vse-overlay-show";c.VIPActionOverlayShowClassName="vse-vip-ao-show";c.VIPActionOverlayBgShadowClassName="vse-carousel-bg-animation";c.VIPMetadataClassName="vse-lb-video-metadata";c.VIPVideoInfoClassName="vse-video-info";c.VIPVideoHelpfulVotesClassName=
"vse-helpful-votes";c.VIPVideoTitleWrapperClassName="video-title-ellipsis-wrapper";c.VIPPlayPauseClassName="vse-vip-play-pause-forward-previous-btns-container";c.VIPScrubberClassName="vse-vip-controls";c.UpNextClassName="vse-up-next";c.UpNextVideoTitleClassName="vse-up-next-video-title";c.UpNextAuthorClassName="vse-up-next-author";c.UpNextCancelClassName="vse-up-next-cancel";c.UpNextElementClassName="vse-upn-element";c.VIPCCButtonUnpressedClassName="vse-cc-unpressed";c.VIPCCButtonPressedClassName=
"vse-cc-pressed";c.VIPVideoCarouselOpenedClassName="vse-vip-video-carousel-opened";c.VIPProductCarouselOpenedClassName="vse-vip-product-carousel-opened";c.METRIC_WIDGET_CLICK=":widget:click";c.METRIC_VIP_OPEN="vip:open";c.METRIC_VIP_CLOSE="vip:close";c.METRIC_VIP_CLOSE_WITHOUT_PLAY="vip:close:without:play";c.METRIC_PLAY="vip:play:icon:click";c.METRIC_PAUSE="vip:pause:icon:click";c.METRIC_SKIP_FORWARD="vip:skip:forward:icon:click";c.METRIC_SKIP_BACK="vip:skip:back:icon:click";c.METRIC_SHOP_ICON="vip:shop:icon:click";
c.METRIC_PFO_CLICK="shop:pfo:click";c.METRIC_PFO_RENDER="shop:pfo:render";c.METRIC_PFO_IMPRESSION="shop:pfo:impression";c.METRIC_WATCH_ICON="vip:watch:icon:click";c.METRIC_WATCH_THUMBNAIL_CLICK="vip:watch:thumbnail:click";c.METRIC_WATCH_THUMBNAIL_RENDER="vip:watch:thumbnail:render";c.METRIC_WATCH_THUMBNAIL_IMPRESSION="vip:watch:thumbnail:impression";c.METRIC_SHARE_ICON="share:icon:click";c.METRIC_SHARE_SELECTION_CLICK="share:selection:click";c.AUTOPLAY_FALLBACK_EXECUTED="vse:autoplay:fallback";c.METRIC_REPORT_CLICK=
"report:icon:click";c.METRIC_REPORT_SUBMIT="report:icon:submit";return c}(),ea=function(){return function(c){var b=this;this.config=c;this.setOrientationConfig=function(a){b.orientationConfig=a};this.updateActiveVideoContentId=function(a){b.activeVideoContentId=a};this.triggerWatchIconInteractionOpen=function(){b.config.A.$("#"+b.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click()};this.triggerShopIconInteractionOpen=function(){b.config.A.$("#"+b.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").click()};
this.handleWatchIconInteractions=function(){b.config.A.$("#"+b.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:open");a=function(){b.config.A.$("#"+b.templateId+" "+f.VIPProductCarouselOverlaySelector).hide();b.config.A.$("#"+b.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);b.toggleIconsState(!0,f.VIPWatchIconSelector);
b.toggleIconsState(!1,f.VIPShopIconSelector);g.innerWidth>g.innerHeight&&b.config.A.$("#"+b.templateId+" "+f.VIPLbCarouselViewportSelector).height(g.innerHeight-b.config.A.$("#"+b.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0));b.config.A.$("#"+b.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).addClass(f.VIPLbOverlayShowCssClassName);b.config.A.$("#"+b.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).removeClass(f.VIPActionOverlayBgShadowClassName);b.config.A.fadeIn(b.config.A.$("#"+
b.templateId+" "+f.VIPLbTabsContainerSelector),300,"linear");b.config.A.$("#"+b.templateId+" "+f.VIPLbCarouselSelector).animate(b.orientationConfig.carouselAnimationType,300,function(){b.lightboxCarousel.scrollToActiveVideo(b.lightboxCarousel.getActiveAsset())});b.config.A.$("#"+b.templateId+" .vjs-text-track-display").addClass(f.VIPVideoCarouselOpenedClassName)};b.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)?b.closeProductCarousel(a):a()})};this.handleMoreVideosIconInteractions=function(){b.config.A.$("#"+
b.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:open");a=function(){b.config.A.$("#"+b.templateId+" "+f.VIPProductCarouselOverlaySelector).hide();b.config.A.$("#"+b.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);b.toggleIconsState(!0,f.VIPWatchIconSelector);b.toggleIconsState(!1,f.VIPShopIconSelector);b.config.A.$("#"+
b.templateId+" "+f.VIPOverlaySelector).addClass(f.VIPOverlayShowClassName)};b.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)?b.closeProductCarousel(a):a()})};this.handleShopIconInteractions=function(){b.config.A.$("#"+b.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").click(function(a){a.stopPropagation();a.stopImmediatePropagation();b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:open");a=function(){b.config.A.$("#"+b.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).removeClass(f.VIPLbOverlayShowCssClassName);
b.config.A.$("#"+b.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);b.toggleIconsState(!0,f.VIPShopIconSelector);b.toggleIconsState(!1,f.VIPWatchIconSelector);b.config.A.$("#"+b.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).removeClass("aok-hidden");b.config.A.$("#"+b.templateId+" "+f.VIPProductCarouselOverlaySelector).show();b.config.A.$("#"+b.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).removeClass(f.VIPActionOverlayBgShadowClassName);
b.config.A.$("#"+b.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).animate(b.orientationConfig.carouselAnimationType,300);b.config.A.$("#"+b.templateId+" .vjs-text-track-display").addClass(f.VIPProductCarouselOpenedClassName)};b.isDisplayed(f.VIPLbCarouselSelector)?b.closeVideoCarousel(a):a()})};this.toggleIconsState=function(a,d){a?(b.config.A.$("#"+b.templateId+" "+d+".vse-unpressed").addClass("aok-hidden"),b.config.A.$("#"+b.templateId+" "+d+".vse-pressed").removeClass("aok-hidden")):(b.config.A.$("#"+
b.templateId+" "+d+".vse-unpressed").removeClass("aok-hidden"),b.config.A.$("#"+b.templateId+" "+d+".vse-pressed").addClass("aok-hidden"))};this.handleVIPCarouselClose=function(){[f.VIPLbCarouselSelector,f.VIPLbTabsContainerSelector,f.RELATED_PRODUCTS_CONTAINER_SELECTOR].forEach(function(a){b.config.A.$(b.config.A.$("#"+b.templateId+" "+a)).click(function(a){b.config.A.$(a.target).closest(f.RELATED_PRODUCTS_ITEM_SELECTOR).length||(a.stopPropagation(),a.stopImmediatePropagation())})});b.config.A.$("#"+
b.templateId+" "+f.VIPActionOverlaySelector).click(function(){b.reset();b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:close")})};this.handleShareIconInteractions=function(){b.config.A.off("a:sheet:beforeShow:"+b.socialShareId+"-sheet");b.config.A.off("a:sheet:afterHide:"+b.socialShareId+"-sheet");b.config.A.on("a:sheet:beforeShow:"+b.socialShareId+"-sheet",function(){b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:open");b.toggleIconsState(!0,f.VIPShareIconSelector)});b.config.A.on("a:sheet:afterHide:"+
b.socialShareId+"-sheet",function(){b.config.A.trigger("vse:"+b.templateId+":vip:vat:component:close");b.toggleIconsState(!1,f.VIPShareIconSelector)})};this.reset=function(){b.unpressAllActionIcons();b.isDisplayed(f.VIPLbCarouselSelector)&&b.closeVideoCarousel(function(){b.config.A.$("#"+b.templateId+" "+f.VIPLbTabsAndCarouselContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);b.config.A.delay(function(){b.config.A.$("#"+b.templateId+" "+f.VIPLbTabsAndCarouselOverlaySelector).removeClass(f.VIPLbOverlayShowCssClassName)},
310)});b.isDisplayed(f.RELATED_PRODUCTS_CONTAINER_SELECTOR)&&b.closeProductCarousel(function(){b.config.A.$("#"+b.templateId+" "+f.VIPProductCarouselOverlayContainerSelector).addClass(f.VIPActionOverlayBgShadowClassName);b.config.A.delay(function(){b.config.A.$("#"+b.templateId+" "+f.VIPProductCarouselOverlaySelector).hide()},310)})};this.unpressAllActionIcons=function(){b.config.A.$("#"+b.templateId+" "+f.VIPActionIconSelector+" .vse-pressed").addClass("aok-hidden");b.config.A.$("#"+b.templateId+
" "+f.VIPActionIconSelector+" .vse-unpressed").removeClass("aok-hidden")};this.closeProductCarousel=function(a){b.config.A.$("#"+b.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).animate(b.orientationConfig.carouselAnimationType,300,a);b.config.A.$("#"+b.templateId+" .vjs-text-track-display").removeClass(f.VIPProductCarouselOpenedClassName)};this.closeVideoCarousel=function(a){b.config.A.fadeOut(b.config.A.$("#"+b.templateId+" "+f.VIPLbTabsContainerSelector),300,"linear");b.config.A.$("#"+b.templateId+
" "+f.VIPLbCarouselSelector).animate(b.orientationConfig.carouselAnimationType,300,a);b.config.A.$("#"+b.templateId+" .vjs-text-track-display").removeClass(f.VIPVideoCarouselOpenedClassName)};this.isDisplayed=function(a){return"block"==b.config.A.$("#"+b.templateId+" "+a).css("display")};this.lightboxCarousel=c.contentCarousel;this.socialShareId=c.socialShareId;this.templateId=c.templateId}}(),V=function(){function c(b){var a=this;this.A=b;this.makeApplicationSushiPayloadBuilder=function(a,b){return I.makeApplicationSushiPayloadBuilder(a,
b)};this.getCurrentlyPlayingVideoInCarousel=function(d){return a.getCombinedPlaylist()[d]};this.getCurrentlyPlayingVideoInCarouselMarkAsPlaying=function(d){d=a.getCurrentlyPlayingVideoInCarousel(d);a.markPlaying(d);return d};this.startPlaying=function(d){a.vars.isContinuousPlayFinished=!1;d?a.vars.player.play(d):a.vars.player.play()};this.updateMediaInfo=function(d){a.updateBasicMediaInfo(d.title,d.vendorName);a.isCustomerReviewVideo(d)?(a.dom.$activeVideoTitlePrefix.removeClass("aok-hidden"),a.dom.$activeVideoCRLink.removeClass("aok-hidden"),
a.dom.$activeVideoCRLinkWrapper.removeClass("aok-hidden")):(a.dom.$activeVideoTitlePrefix.addClass("aok-hidden"),a.dom.$activeVideoCRLink.addClass("aok-hidden"),a.dom.$activeVideoCRLinkWrapper.addClass("aok-hidden"));a.dom.$activeVideoCRLink.attr("href",d.referenceUrl||"");a.vars.showVotes&&a.relatedVideosCarouselNotEmpty()&&(a.updateActiveVideoVoteContainer(d),a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0));a.isInfluencerVideo(d)?(a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),
a.dom.$wrapper.find(f.ibVideoAiDisclosure).removeClass("aok-hidden")):(a.isOspEnabled(d)?a.dom.$wrapper.find(f.ibVideoOspDisclosure).removeClass("aok-hidden"):a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),a.dom.$wrapper.find(f.ibVideoAiDisclosure).addClass("aok-hidden"));a.vars.shouldShowProfiles&&(a.isInfluencerVideo(d)?a.updateInfluencerProfile(d):a.updateCustomerProfile(d))};this.updateCustomerProfile=function(d){d=a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+d.contentId+
'"]').find(".vse-video-customer-profile");0<d.length?(a.dom.$activeVideoCustomerProfile.html(d.clone().removeClass("vse-hidden").html()),a.dom.$videoAuthorBlock.addClass("vse-hidden"),a.dom.$customerProfileContainer.removeClass("vse-no-cp")):(a.dom.$activeVideoCustomerProfile.html(""),a.dom.$videoAuthorBlock.removeClass("vse-hidden"),a.dom.$customerProfileContainer.addClass("vse-no-cp"))};this.updateInfluencerProfile=function(d){d=a.dom.$lbVideoCarousel.find('[data-asin\x3d"'+d.contentId+'"]').find(".vse-video-influencer-profile");
0<d.length&&(d=d.clone(),a.dom.$activeVideoCustomerProfile.html(d.removeClass("vse-hidden").html()),a.dom.$wrapper.find(f.ibVideoOspDisclosure).addClass("aok-hidden"),a.dom.$wrapper.find(f.ibVideoAiDisclosure).addClass("aok-hidden").clone().removeClass("aok-hidden").insertAfter(a.dom.$activeVideoCustomerProfile.find(".vse-profile")),a.dom.$videoAuthorBlock.addClass("vse-hidden"),a.dom.$customerProfileContainer.removeClass("vse-no-cp"),a.handleInfluencerProfileNameClick(),a.handleInfluencerAvatarClick())};
this.needToUpdateVideoInfoLater=function(){return a.isImageBlockVIP()&&!a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)&&a.vars.A.objectIsEmpty(a.vars.currentAssetSpec.title)};this.updateVideoMetadataIfNeeded=function(d){a.needToUpdateVideoInfoLater()&&(a.updateBasicMediaInfo(d.title,d.vendorName),a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),a.vars.showClosedCaptions&&!a.vars.A.objectIsEmpty(d.closedCaptions)&&0<d.closedCaptions.length&&a.vars.player.updateTextTrack(d.closedCaptions))};
this.clearCurrentVideoInfo=function(){a.updateBasicMediaInfo("","")};this.updateBasicMediaInfo=function(d,b){a.dom.$wrapper.find(f.videoTitle).text(d);a.dom.$wrapper.find(f.vendorName).text(b)};this.isImageBlockVIP=function(){return a.vars.isVideoImmersivePlayer&&-1!==a.vars.clientPrefix.indexOf("imageblock")};this.createContinuousPlayPlaylist=function(d){a.vars.playlist=a.getCombinedPlaylist();for(var b=0;b<a.vars.playlist.length&&a.vars.playlist[0].contentId!==d.contentId;b++)a.vars.playlist.push(a.vars.playlist.shift())};
this.updateFeedback=function(d){a.vars.A.objectIsEmpty(a.vars.feedback)||a.vars.A.objectIsEmpty(d)||a.vars.feedback.setActiveVideoAndSource(d.contentId,d.vendorCode)};this.initializeHelpfulVotes=function(){if(a.vars.showVotes){var d=a.getActiveAsset();a.updateActiveVideoVoteContainer(d);a.vars.A.on(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes",function(){a.vars.activeVideoVoteContainer.showOrHide(!1,!1,!1,!1);a.vars.videoVoteFailure=!0});a.vars.A.off("a:declarative:"+
(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive")+":click");a.vars.A.off("a:declarative:"+(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-negative")+":click");a.vars.A.declarative(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-positive","click",function(){a.castVote(k.POSITIVE_VOTE)});a.vars.A.declarative(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-negative","click",function(){a.castVote(k.NEGATIVE_VOTE)});
a.vars.A.on(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",function(b){var c=b===k.POSITIVE_VOTE?k.NEGATIVE_VOTE:k.POSITIVE_VOTE,g=k.EMPTY_STRING;d&&d.videoVoteContainer&&(g=d.videoVoteContainer.getPreviousVote()===b?"cancel:"+b:d.videoVoteContainer.getPreviousVote()===k.POSITIVE_VOTE||d.videoVoteContainer.getPreviousVote()===k.NEGATIVE_VOTE?"switch-"+c+"-to-"+b:b,d.videoVoteContainer.updateWithNewVote(b));a.vars.emitSushiMetric&&(b=a.vars.buildSushiPayload({eventName:a.vars.clientPrefix+
"ibiv.videovote.castvote:"+g,stringPayload:f.EMPTY_STRING,intPayload:1,videoAsin:d.contentId}),l.emitSushiMetric(b,a.vars.sushiMetricsConfig.endpoint))})}};this.shouldShowVotes=function(d){return a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig&&d&&d.videoVoteContainer&&!a.vars.videoVoteFailure};this.show=function(d){a.updateMediaInfo(d);a.updateFeedback(d);a.showRelatedProducts(d);a.refreshSocialSharePageState(d);a.rotateTo(d);a.vars.isVideoImmersivePlayer&&a.showOrHideClosedCaptions(d)};
this.showOrHideClosedCaptions=function(d){a.vars.showClosedCaptions&&d.closedCaptions&&(0<d.closedCaptions.length?a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCButtonSelector).show():a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCButtonSelector).hide())};this.updateActiveVideoVoteContainer=function(d){a.vars.activeVideoVoteContainer.setPreviousVote(k.NONE_VOTE);a.vars.activeVideoVoteContainer.setContentId(d.contentId);a.vars.activeVideoVoteContainer.setVoteCount(k.POSITIVE_VOTE,d.videoVoteContainer.getVoteCount(k.POSITIVE_VOTE));
a.vars.activeVideoVoteContainer.setVoteCount(k.NEGATIVE_VOTE,d.videoVoteContainer.getVoteCount(k.NEGATIVE_VOTE));a.fetchAndUpdateVotingCount(d);a.fetchAndUpdateVotingHistory(d)};this.castVote=function(d){if(a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig){var b=a.vars.activeVideoVoteContainer.getPreviousVote(),c=d===k.POSITIVE_VOTE&&b!=k.POSITIVE_VOTE,b=d===k.NEGATIVE_VOTE&&b!=k.NEGATIVE_VOTE;a.vars.activeVideoVoteContainer.updateWithNewVote(d);a.vars.videoVoteContainerFactory.sendVoteToRemote(c,
b,a.vars.activeVideoVoteContainer.getContentId()).then(function(b){a.vars.videoVoteContainerFactory&&a.vars.videoVoteContainerFactory.videoVoteConfig&&a.vars.A.trigger(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-vote-cast",d)},function(b){l.count(a.vars.clientPrefix+".videovote.votecastfailure",1);a.vars.activeVideoVoteContainer.updateWithNewVote(d)})}};this.fetchAndUpdateVotingCount=function(d){d.videoVoteContainer&&!d.videoVoteContainer.countsFetched&&a.vars.videoVoteContainerFactory.fetchVoteCounts([d.contentId]).then(function(b){a.relatedVideosCarouselNotEmpty()&&
a.updateVotingElements(d,b,!1);for(var c=0;c<b.length;c++)if(b[c].contentId===d.contentId){d.videoVoteContainer.setVoteCount(k.POSITIVE_VOTE,b[c].positiveVoteCount);d.videoVoteContainer.setVoteCount(k.NEGATIVE_VOTE,b[c].negativeVoteCount);d.videoVoteContainer.countsFetched=!0;a.vars.activeVideoVoteContainer.setVoteCount(k.POSITIVE_VOTE,b[c].positiveVoteCount);a.vars.activeVideoVoteContainer.setVoteCount(k.NEGATIVE_VOTE,b[c].negativeVoteCount);break}a.vars.activeVideoVoteContainer.countsFetched=!0;
a.vars.activeVideoVoteContainer.showOrHide(!0,!0,!0,!0)},function(d){l.count(a.vars.clientPrefix+".videovote.votecountfailure",1);a.vars.A.trigger(a.vars.videoVoteContainerFactory.videoVoteConfig.actionPrefix+"-hide-votes")})};this.fetchAndUpdateVotingHistory=function(d){d.videoVoteContainer&&(d.videoVoteContainer.getPreviousVote()!==k.EMPTY_STRING?a.vars.activeVideoVoteContainer.setPreviousVote(d.videoVoteContainer.getPreviousVote()):a.vars.videoVoteContainerFactory.fetchVoteHistory(d.contentId).then(function(b){a.vars.videoVoteContainerFactory===
u||b!==k.POSITIVE_VOTE&&b!==k.NEGATIVE_VOTE&&b!==k.NONE_VOTE||(a.vars.activeVideoVoteContainer.setPreviousVote(b),d.videoVoteContainer.setPreviousVote(b))},function(d){l.count(a.vars.clientPrefix+".videovote.votehistoryfailure",1)}))};this.showRelatedProducts=function(d){a.fadeOutRelatedProductsContainer();var b=d.relatedProducts;b!==u&&(a.retrieveRelatedProductsCarouselFromCache(d.contentId)!==u?a.getRelatedProductsFromCache(d.contentId):a.getRelatedProducts(1,b,d.contentId))};this.getRelatedProducts=
function(d,b,c){if(d>f.AJAX_MAX_RETRY_COUNT)a.handleGetRelatedProductsFailure();else{var g=!0;0<a.vars.relatedProductsNilgiriRequestCount&&(g=!1);var h=w.fetchLatestPageState(a.vars.A,a.vars.clientPrefix+"-related-products-request-ps");if(h){var n=h.componentConfiguration,h=h.pageContext;if(n&&h&&n.features&&n.features.features){h.metadata?h.metadata.relatedProductsAsins=b:h.metadata={relatedProductsAsins:b};var k=a.vars.A.objectIsEmpty(a.vars.productAsin)?"":a.vars.productAsin,g={pageContext:{page:h.page,
placement:h.placement,marketplaceID:h.marketplaceID,locale:h.locale,customerId:h.customerId,requestId:h.requestId,product:{contentID:k,contentIDType:"ASIN"},metadata:h.metadata},configuration:{id:n.id,type:n.type,binder:n.binder,assets:g?["ProductCarousel"]:[],features:{features:n.features.features}}};a.vars.relatedProductsRequest=g;a.vars.relatedProductsCarouselName=n.features.features.carouselName;a.vars.keepProductCarouselOpenOnClick=null!=n.features.features.keepProductCarouselOpenOnClick?n.features.features.keepProductCarouselOpenOnClick:
!1;y.sendRequest(a.vars.A,""+f.VAP_EW+f.RELATED_PRODUCTS_ENDPOINT,g,function(d){-1!==d.indexOf(f.RELATED_PRODUCTS_INNER_CLASS_NAME)?(a.cacheRelatedProductsPayload(c,d),a.handleGetRelatedProductsSuccess(c),a.vars.$(a.dom.$wrapper).delegate(f.RELATED_PRODUCTS_ITEM_SELECTOR+" a","click",function(d){d.stopPropagation();d.stopImmediatePropagation();var b=a.vars.$(d.target).closest("li").find(f.RELATED_PRODUCTS_ITEM_SELECTOR),c=b.attr("data-asin"),b=b.hasClass("vse-sponsor-product").toString();a.emitPFOClickMetric(f.METRIC_PFO_CLICK,
c,b);d=a.vars.$(d.target).closest("li").find(".vse-carousel-item").attr("href");a.openExternalLinkFromLightBox(d)}),a.vars.isVideoImmersivePlayer?(a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselViewportSelector).unbind("scroll"),a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselViewportSelector).bind("scroll",a.emitPFOImpressionMetricVIPHandler)):(a.vars.A.off("a:carousel:"+a.vars.relatedProductsCarouselName+":init",a.emitPFOImpressionMetricInitHandler),a.vars.A.on("a:carousel:"+a.vars.relatedProductsCarouselName+
":init",a.emitPFOImpressionMetricInitHandler)),a.vars.A.objectIsEmpty(a.vars.A.$(f.LB_CAROUSEL_CONFIG).attr("data-configuration"))&&a.emitPFORenderMetric(f.METRIC_PFO_RENDER),l.count(a.vars.clientPrefix+":relatedproducts:load:success",1),a.vars.A.trigger(a.vars.clientPrefix+":relatedproducts:load:success"),a.vars.relatedProductsNilgiriRequestCount+=1):a.handleGetRelatedProductsFailure()},function(e){d+=1;a.getRelatedProducts(d,b,c)})}}else l.count(f.RELATED_PRODUCT_PAGE_STATE_NOT_FOUND_ERROR_KEY,
1)}};this.cacheRelatedProductsPayload=function(d,b){d=a.vars.popoverId+"-vse-pc-hidden-cache-"+d;a.vars.$("#"+a.vars.popoverId+" "+f.CACHE_RP_PAYLOAD_HIDDEN_DIV_CONTAINER).append("\x3cdiv id\x3d'"+d+"'\x3e"+b+" \x3c/div\x3e")};this.retrieveRelatedProductsCarouselFromCache=function(d){d=a.vars.$("#"+a.vars.popoverId+"-vse-pc-hidden-cache-"+d+" "+f.RELATED_PRODUCTS_INNER_CONTAINER);if(d!==u&&d[0]!==u)return d[0].outerHTML};this.handleGetRelatedProductsSuccess=function(d){var b=a.retrieveRelatedProductsCarouselFromCache(d);
a.hideCurrentlyVisibleProductContainer();var c=a.vars.popoverId+"-"+f.VISIBLE_DIV_NARROW_PREFIX+d;a.vars.$("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).append('\x3cdiv class\x3d"vse-pc-visible aok-hidden" id\x3d\''+c+"'\x3e"+b+"\x3c/div\x3e");a.vars.$("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR+" #"+c+" .a-carousel-left").attr("data-element-id",a.vars.clientPrefix+"-pc-left-button");a.vars.$("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR+" #"+
c+" .a-carousel-right").attr("data-element-id",a.vars.clientPrefix+"-pc-right-button");a.resizeLB();a.showRelatedProductCarousel(d);a.fadeInRelatedProductsContainer(d)};this.getRelatedProductsFromCache=function(d){a.hideCurrentlyVisibleProductContainer();a.showRelatedProductCarousel(d);a.fadeInRelatedProductsContainer(d)};this.hideCurrentlyVisibleProductContainer=function(){a.dom.$relatedProductContainer.find(".vse-pc-visible").addClass("aok-hidden");a.hideVIPProductCarouselEmptyViewContainer()};
this.hideVIPProductCarouselEmptyViewContainer=function(){a.vars.isVideoImmersivePlayer&&a.vars.A.$(f.VIPEmptyRelatedProductsContainerSelector).addClass("aok-hidden")};this.showVIPProductCarouselEmptyViewContainer=function(){a.vars.isVideoImmersivePlayer&&a.vars.A.$(f.VIPEmptyRelatedProductsContainerSelector).removeClass("aok-hidden")};this.showRelatedProductCarousel=function(d){a.vars.A.show(a.vars.$("#"+a.vars.popoverId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR));a.vars.$("#"+a.vars.popoverId+"-"+
f.VISIBLE_DIV_NARROW_PREFIX+d).removeClass("aok-hidden")};this.handleGetRelatedProductsFailure=function(){l.count(a.vars.clientPrefix+":relatedproducts:load:failed",1);a.vars.showLightboxV2Experience?a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR).css({visibility:"hidden"}):a.vars.A.hide(a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR));a.vars.isVideoImmersivePlayer&&(a.hideCurrentlyVisibleProductContainer(),a.showVIPProductCarouselEmptyViewContainer())};this.fadeOutRelatedProductsContainer=function(){a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR+
" "+f.RELATED_PRODUCTS_INNER_CONTAINER).fadeOut(0)};this.fadeInRelatedProductsContainer=function(d){a.vars.$("#"+a.vars.popoverId+"-"+f.VISIBLE_DIV_NARROW_PREFIX+d+" "+f.RELATED_PRODUCTS_INNER_CONTAINER).animate({opacity:1},0);a.vars.$(f.RELATED_PRODUCTS_CONTAINER_SELECTOR+" "+f.RELATED_PRODUCTS_INNER_CONTAINER).fadeIn(200)};this.showFeedbackLink=function(d,b){a.vars.$(d).css({display:"inline-block"});a.vars.$(b+" video").addClass("dim-video-player")};this.hideFeedbackLink=function(d,b){a.vars.$(d).css({display:"none"});
a.vars.$(b+" video").removeClass("dim-video-player")};this.deRegisterFeedback=function(d){a.vars.A.off("vse:"+d+":feedback:shown");a.vars.A.off("vse:"+d+":feedback:hidden");a.vars.A.off("vse:ns:feedback:"+d+":init:client")};this.setVideoDetails=function(d,b){a.vars.initialVideo={index:0,title:b.videoTitle,vendorName:b.vendorName,contentId:d,vendorCode:b.vendorCode,videoUrl:b.videoUrl,imageUrl:b.imageUrl,productAsin:b.productAsin,videoReferenceId:b.videoReferenceId}};this.attachPlayerEventListeners=
function(){a.vars.player&&(a.vars.player.on("playbackComplete",a._playbackCompleteHandler),a.vars.player.on("playbackStart",a._firstFrameHandler))};this.attachReviewsPlayerEventListeners=function(){if(a.vars.player)a.vars.player.on("playbackComplete",a._reviewsPlaybackCompleteHandler)};this.removeUpNextComponent=function(){a.vars.upNextTimeoutHandle&&clearTimeout(a.vars.upNextTimeoutHandle);a.vars.intervalUserActivityHandlerId=a.userActivityCountDown();a.vars.A.show(a.vars.$("#"+a.vars.templateId+
" "+f.videoInformationContainer));a.dom.$wrapper.find("."+f.UpNextElementClassName).addClass("vse-hidden");a.dom.$wrapper.find(f.VIPSkipBackButtonSelector).removeClass("aok-hidden");a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector).removeClass("aok-hidden");a.vars.$("#"+a.vars.templateId+" ."+f.UpNextCancelClassName).unbind("click");a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,!a.vars.vipControlsShouldPause);
a.vars.isUpNextComponentActive=!1};this._playUpNextHandler=function(){if(a.relatedVideosCarouselNotEmpty()){var d=a.getActiveAsset(),b=a._getNextAsset(d);b&&(a.vars.vipControlsShouldPause=!1,a.vars.lightBoxPausedVideo=!1,a.removeUpNextComponent(),d.eventTimestamp&&(b.eventTimestamp=d.eventTimestamp),a.vars.player.play(b),a.show(b),a.vars.currentAssetSpec=b)}};this._cancelContinuousPlayHandler=function(){if(a.relatedVideosCarouselNotEmpty()){var d=a.getActiveAsset();a.vars.player.loadNextVideoPoster(d.imageUrl);
a.vars.vipControlsShouldPause=!0;a.removeUpNextComponent();a.vars.vipControlsShouldPause=!1;a.vars.lightBoxPausedVideo=!0}};this.continuousPlay=function(d,b){d.eventTimestamp&&(b.eventTimestamp=d.eventTimestamp);a.refTagRecorder.emitRefTag(b.continuousPlayRefTag);a.vars.player.play(b);a.show(b)};this._playbackCompleteHandler=function(){if(a.relatedVideosCarouselNotEmpty()){var d=a.getActiveAsset(),b=a._getNextAsset(d);b?a.vars.useUpNextComponent?(a.vars.isUpNextComponentActive=!0,a.vars.vipControlsShouldPause=
!0,a.vars.lightBoxPausedVideo=!0,a.clearIntervalUserActivityHandler(),a.dom.$wrapper.find(f.VIPSkipBackButtonSelector).addClass("aok-hidden"),a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector).addClass("aok-hidden"),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,!a.vars.vipControlsShouldPause),a.vars.A.hide(a.vars.$("#"+a.vars.templateId+" "+f.videoInformationContainer)),a.vars.vipControlsShouldPause=
!1,a.vars.lightBoxPausedVideo=!1,a.vars.player.loadNextVideoPoster(b.imageUrl),a.dom.$wrapper.find("."+f.UpNextVideoTitleClassName).text(b.title),a.dom.$wrapper.find("."+f.UpNextAuthorClassName).text(b.vendorName),a.dom.$wrapper.find("."+f.UpNextElementClassName).removeClass("vse-hidden"),a.vars.$("#"+a.vars.templateId+" ."+f.UpNextCancelClassName).click(a._cancelContinuousPlayHandler),a.showVideoImmersivePlayerOverlay(),a.resetUserActivityTimer(-2),a.vars.upNextTimeoutHandle=a.vars.A.delay(function(){a.removeUpNextComponent();
a.continuousPlay(d,b);a.vars.currentAssetSpec=b},5E3)):a.continuousPlay(d,b):(a.vars.isVideoImmersivePlayer&&(a.clearIntervalUserActivityHandler(),a.vars.lightBoxPausedVideo=!0,a.vars.vipControlsShouldPause=!1,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause),a.showVideoImmersivePlayerOverlay()),a.vars.isContinuousPlayFinished=!0)}};this._reviewsPlaybackCompleteHandler=
function(){a.clearIntervalUserActivityHandler();a.dom.$wrapper.find(f.VIPTimeRemainingSelector).text("-0:00");a.vars.lightBoxPausedVideo=!0;a.vars.vipControlsShouldPause=!1;a.toggleVipPlayPauseClass();a.showVideoImmersivePlayerOverlay();a.vars.isContinuousPlayFinished=!0};this._firstFrameHandler=function(){a.vars.isMobile&&a.hideFeedbackLink("#vse-"+a.vars.clientPrefix+"-feedback-container","#"+a.vars.containerId+"-container");a.vars.isVideoImmersivePlayer&&(a.vars.player.getMediaDuration()!==a.vars.vipVideoDuration&&
(a.vars.vipVideoDuration=a.vars.player.getMediaDuration()),a.vars.vipControlsShouldPause=!0,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause))};this._getNextAsset=function(b){for(var c=0;c<a.vars.playlist.length&&a.vars.playlist[c].contentId!=b.contentId;c++);if(c!=a.vars.playlist.length)return a.vars.playlist[c+1]};this._playerFailedAutoplayHandler=function(){a.vars.vipControlsShouldPause=
!1;a.toggleVipPlayPauseClass();l.count(f.AUTOPLAY_FALLBACK_EXECUTED,1)};this._playerSucceededAutoplayHandler=function(){a.clearIntervalUserActivityHandler();a.vars.intervalUserActivityHandlerId=a.userActivityCountDown();a.vars.vipPlayIconClicked=!0;a.vars.useAutoplayFallback=!1};this.onPlayerTapHandler=function(){a.showVideoImmersivePlayerOverlay();a.resetUserActivityTimer()};this.pauseVideoIfNeeded=function(){a.vars.player&&a.vars.player.isPlaying()&&(a.vars.player.pause(),a.vars.lightBoxPausedVideo=
!0,a.vars.isVideoImmersivePlayer&&a.vars.isVIPOverlayTimerSet&&a.clearIntervalUserActivityHandler())};this.resumeVideoIfNeeded=function(){a.vars.lightboxOpened&&(a.vars.player&&a.vars.player.isPlaying()&&(a.vars.player.pause(),a.vars.lightBoxPausedVideo=!0),a.vars.player&&!a.vars.player.isPlaying()&&!a.vars.isContinuousPlayFinished&&a.vars.lightBoxPausedVideo?(a.vars.player.resume(Date.now()),a.vars.isVideoImmersivePlayer&&!a.vars.isVIPOverlayTimerSet&&(a.resetUserActivityTimer(),a.showVideoImmersivePlayerOverlay(),
a.vars.intervalUserActivityHandlerId=a.userActivityCountDown())):a.vars.useAutoplayFallback&&(a.startPlaying(a.vars.currentAssetSpec),a.vars.intervalUserActivityHandlerId=a.userActivityCountDown(),a.vars.vipPlayIconClicked=!0,a.vars.useAutoplayFallback=!1),a.vars.isVideoImmersivePlayer&&a.vars.isContinuousPlayFinished&&a.vars.initialVideo&&(a.startPlaying(a.vars.initialVideo),a.show(a.vars.initialVideo)),a.vars.lightBoxPausedVideo=!1)};this.setInitialClosedCaptions=function(b,c){var f=[];if(!a.vars.A.objectIsEmpty(c)){c=
c.split(",");for(var g=0;g<c.length;g+=2)c[g+1]!==u&&f.push({locale:c[g],url:c[g+1]})}b.closedCaptions=f};this.setupVIPClosedCaptions=function(b,c){var g="#"+a.vars.templateId+" "+f.VIPCCButtonSelector;a.vars.A.$(g+"."+f.VIPCCButtonUnpressedClassName).live("click",function(){a.vars.A.$(""+g).removeClass(f.VIPCCButtonUnpressedClassName).addClass(f.VIPCCButtonPressedClassName);a.vars.player.enableCurrentTextTrack();a.showTempCCPopup(b.defaultText)});a.vars.A.$(g+"."+f.VIPCCButtonPressedClassName).live("click",
function(){a.vars.A.$(""+g).removeClass(f.VIPCCButtonPressedClassName).addClass(f.VIPCCButtonUnpressedClassName);a.vars.player.disableCurrentTextTrack();a.showTempCCPopup(b.captionsOffText)});a.vars.A.objectIsEmpty(c)&&a.vars.A.$(""+g).hide()};this.showTempCCPopup=function(b){a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCTooltipTextSelector).text(b);a.vars.A.$("#"+a.vars.templateId+" "+f.VIPCCTooltipSelector).removeClass("aok-hidden");setTimeout(function(){return a.vars.A.$("#"+a.vars.templateId+" "+
f.VIPCCTooltipSelector).addClass("aok-hidden")},3E3)};this.setupDefaultClosedCaptions=function(){a.vars.A.$("#"+a.vars.templateId+" "+f.defaultPlayerCCButtonTitleSelector).removeAttr("title")};this.constructShareBaseUrl=function(){return(a.vars.A.objectIsEmpty(g.location.origin)?"https://www.amazon.com":g.location.origin)+"/vdp/"};this.refreshSocialSharePageState=function(b){var c=a.constructShareBaseUrl()+b.contentId;a.vars.A.objectIsEmpty(a.vars.productAsin)||(c+="?product\x3d"+a.vars.productAsin);
a.vars.A.state.replace(a.vars.socialSharePageState,{pageLevelData:{clientRef:"ib",deviceTypeRef:a.vars.isMobile?"mb":"dt"},url:c,image:b.imageUrl,title:b.title,description:b.title})};this.getMshopShareParams=function(b){var c=a.constructShareBaseUrl()+b.contentId;b=b.title+" "+c;var f="\x3cdiv\x3e \x3cp\x3e"+b+"\x3c/p\x3e \x3c/div\x3e";return{subject:b,messagePlain160:b.substring(0,160),messagePlain140:b.substring(0,140),messageHTML:f,messagePlain:b,url:c}};this.getDomElements=function(b,c){a.dom.$wrapper=
a.vars.$("#"+b+" #"+c);a.dom.$lbContainer=a.dom.$wrapper.find(".vse-lb-container");a.dom.$lbLeftColumn=a.dom.$wrapper.find(".vse-lb-left");a.dom.$lbRightColumn=a.dom.$wrapper.find(".vse-lb-right");a.dom.$lbCCHeader=a.dom.$wrapper.find(".vse-cc-header");a.dom.$lbTabContainer=a.dom.$wrapper.find(".vse-lightbox-tab");a.dom.$videoAuthor=a.dom.$wrapper.find(".vse-video-author span");a.dom.$mobileFixedContainer=a.dom.$wrapper.find(".vse-common-mobile-fixed-container");a.dom.$mobileMovableContainer=a.dom.$wrapper.find(".vse-vb-movable-container");
a.dom.$relatedProductContainer=a.dom.$wrapper.find(".vse-related-products-narrow");a.dom.$activeVideoOspLink=a.dom.$wrapper.find(".vse-oap-link");a.dom.$activeVideoTitlePrefix=a.dom.$wrapper.find(".vse-title-prefix");a.dom.$activeVideoCRLink=a.dom.$wrapper.find(".vse-cr-link");a.dom.$activeVideoCRLinkWrapper=a.dom.$wrapper.find(".video-title-container-right")};this.getCustomerProfileDomElements=function(){a.dom.$lbVideoCarousel=a.vars.isVideoImmersivePlayer?a.dom.$wrapper.find(".vse-vip-lb-carousel"):
a.dom.$wrapper.find(".vse-related-videos-container");a.dom.$activeVideoCustomerProfile=a.dom.$wrapper.find("#vse-active-video-customer-profile");a.dom.$videoAuthorBlock=a.dom.$wrapper.find(".vse-video-author");a.dom.$customerProfileContainer=a.dom.$wrapper.find(".vse-cp-container");a.dom.$profileLinkSelector=a.dom.$wrapper.find(".vse-profile")};this.shouldSetProductCarouselWidth=function(b){var c=a.dom.$wrapper.find(".vse-lb-right .vse-related-videos-container .a-carousel-row").height();return a.vars.A.isFiniteNumber(c)?
c<b?!0:!1:!1};this.resizeDesktopLB=function(){var b=a.dom.$lbLeftColumn.outerHeight(!0);if(!a.isDesktopVerticalLightBox()){var c=g.innerHeight-a.dom.$wrapper.closest(f.LightboxWrapperSelector).outerHeight();0<c&&a.dom.$wrapper.closest(f.LightboxWrapperSelector).animate({marginTop:c/2+"px",marginBottom:c/2+"px",top:0},0)}0<a.vars.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).length?!a.vars.showLightboxV2Experience&&a.shouldSetProductCarouselWidth(b-a.vars.relatedProductsContainerFixedHeight)?
(a.vars.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).width(a.dom.$lbContainer.outerWidth()),c=b-a.vars.relatedProductsContainerFixedHeight):(a.vars.$("#"+a.vars.templateId+" "+f.RELATED_PRODUCTS_CONTAINER_SELECTOR).removeAttr("style"),c=b):(b=a.dom.$lbTabContainer.length?a.dom.$lbTabContainer.outerHeight(!0):0,c=b=a.vars.$("#"+a.vars.popoverId).height()-(a.dom.$lbContainer.outerHeight(!0)-a.dom.$lbContainer.innerHeight())-b);a.vars.showLightboxV2Experience&&(a.isDesktopVerticalLightBox()?
(a.toggleLightboxCloseButton(!1),c=b,a.dom.$lbRightColumn.css({height:"unset"})):(a.toggleLightboxCloseButton(!0),a.dom.$lbRightColumn.css({height:b})));a.dom.$lbRightColumn.css({"max-height":c});a.vars.A.capabilities.tablet&&(a.dom.$wrapper.closest(f.LightboxWrapperSelector).addClass(f.TALET_LIGHTBOX_CLASS_NAME),a.dom.$wrapper.closest(f.LightboxWrapperSelector).find(f.AUI_POPOVER_INNER).addClass(f.TALET_LIGHTBOX_CLASS_NAME))};this.resizeMobileLB=function(){a.dom.$lbContainer.height(g.innerHeight);
var b=a.vars.$(a.dom.$mobileFixedContainer).outerHeight(!0),b=a.vars.$(g).height()-b;a.vars.$(a.dom.$mobileMovableContainer).animate({"max-height":b})};this.resizeLB=function(){a.vars.isMobile?a.resizeMobileLB():a.resizeDesktopLB()};this.isOspEnabled=function(b){return!a.vars.A.objectIsEmpty(b.vendorTrackingId)&&""!==b.vendorTrackingId};this.showVideoImmersivePlayerOverlay=function(){a.dom.$wrapper.find(f.VIPOverlaySelector).addClass(f.VIPOverlayShowClassName)};this.hideVideoImmersivePlayerOverlay=
function(){a.vars.useMultiCarousel&&a.vars.multiCarouselExpanded&&a.openCloseMultiCarousel();a.dom.$wrapper.find(f.VIPOverlaySelector).removeClass(f.VIPOverlayShowClassName)};this.setUserActivityTimer=function(b){a.vars.$(b.target).hasClass(f.VIPOverlayShowClassName)||a.vars.$(b.target).hasClass(f.UpNextClassName)||a.vars.$(b.target).hasClass(f.VIPMetadataClassName)||a.vars.$(b.target).hasClass(f.VIPVideoInfoClassName)||a.vars.$(b.target).hasClass(f.VIPVideoTitleWrapperClassName)||a.vars.$(b.target).hasClass(f.VIPVideoHelpfulVotesClassName)||
a.vars.$(b.target).hasClass(f.VIPPlayPauseClassName)||a.vars.$(b.target).hasClass(f.VIPScrubberClassName)?a.hideVideoImmersivePlayerOverlay():a.resetUserActivityTimer()};this.resetUserActivityTimer=function(b){void 0===b&&(b=0);a.vars.secondsFromLastActivity=b};this.userActivityCountDown=function(){a.vars.intervalUserActivityHandlerId=a.vars.A.interval(function(){a.vars.multiCarouselExpanded||(a.vars.secondsFromLastActivity++,3<a.vars.secondsFromLastActivity&&a.hideVideoImmersivePlayerOverlay())},
1E3);if(a.vars.isVIPOverlayTimerSet)return a.vars.intervalUserActivityHandlerId;var b="mousedown mousemove keydown touchmove scroll touchstart".split(" ");a.vars.$(""+a.vars.popoverId)&&(b.forEach(function(b){a.dom.$lbContainer.click(function(b){a.vars.customerReviewsConfig&&a.vars.customerReviewsConfig.showCustomerReviewMetadata&&0==a.vars.$(b.target).closest(".vse-reviews-cr-container").length?a.vars.$(f.VIPOverlaySelector).hasClass("vse-reviews-expand-full-cr")&&(a.vars.$(f.VIPOverlaySelector).removeClass("vse-reviews-expand-full-cr"),
a.vars.$(".vse-reviews-content-ellipsis-wrapper").scrollTop(0),a.styleCollapsedReviewText(),a.vars.vipControlsShouldPause||(a.resumeVideoIfNeeded(),a.vars.vipControlsShouldPause=!0,a.toggleVipPlayPauseClass())):a.setUserActivityTimer(b)})}),a.vars.isVIPOverlayTimerSet=!0);return a.vars.intervalUserActivityHandlerId};this.clearIntervalUserActivityHandler=function(){a.vars.isVIPOverlayTimerSet=!1;clearInterval(a.vars.intervalUserActivityHandlerId)};this.emitMetric=function(b){a.vars.emitSushiMetric&&
(b=a.vars.buildSushiPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitClickMetric=function(b){a.vars.emitSushiMetric&&a.relatedVideosCarouselNotEmpty()&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1,videoAsin:a.vars.currentAssetSpec.contentId?a.vars.currentAssetSpec.contentId:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).contentId,groupType:a.vars.currentAssetSpec.groupType?
a.vars.currentAssetSpec.groupType:a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).groupType}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitRelatedVideosRenderMetric=function(b,c){a.vars.emitSushiMetric&&!a.vars.A.objectIsEmpty(c)&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1,videoAsinList:c.getplaylist().map(function(a){return a.contentId+f.COMMA+a.groupType}).join(f.SEMICOLON)}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};
this.emitPFOClickMetric=function(b,c,g){a.vars.emitSushiMetric&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1,productAsin:c,isSponsored:g,videoAsin:a.getVideoAsin(),groupType:a.getGroupType()}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitPFORenderMetric=function(b){a.A.off(" "+a.vars.clientPrefix+":relatedproducts:load:success");a.A.on(" "+a.vars.clientPrefix+":relatedproducts:load:success",function(){if(a.vars.emitSushiMetric){for(var c=a.A.$("#"+
a.vars.templateId+" .vse-pc-visible").not(".aok-hidden").find(".vse-product-item"),g="",k=a.getVideoAsin(),h=[],n=0;n<c.length;n++)h.push([c[n].getAttribute("data-asin"),c[n].classList.contains("vse-sponsor-product").toString(),!1]),g+=c[n].getAttribute("data-asin")+","+c[n].classList.contains("vse-sponsor-product").toString(),n!==c.length-1&&(g+=f.SEMICOLON);a.vars.contentIdProductAsinMap[k]=h;c=a.vars.buildSushiPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1,productAsinList:g,videoAsin:k,
groupType:a.getGroupType()});l.emitSushiMetric(c,a.vars.universalSushiEndpoint)}})};this.getVideoAsin=function(){return a.vars.currentAssetSpec.contentId?a.vars.currentAssetSpec.contentId:a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).contentId:f.EMPTY_STRING};this.getGroupType=function(){return a.vars.currentAssetSpec.groupType?a.vars.currentAssetSpec.groupType:a.relatedVideosCarouselNotEmpty()?a.getCurrentlyPlayingVideoInCarousel(a.vars.currentIndex).groupType:
f.EMPTY_STRING};this.emitPFOImpressionMetric=function(b,c,g){a.vars.emitSushiMetric&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1,productAsin:c,isSponsored:g,videoAsin:a.getVideoAsin(),groupType:a.getGroupType()}),l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitVIPThumbnailImpressionMetric=function(b,c){a.vars.emitSushiMetric&&(b=a.vars.buildSushiPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:1,videoAsin:c.contentId,groupType:c.groupType}),
l.emitSushiMetric(b,a.vars.universalSushiEndpoint))};this.emitVIPThumbnailImpressionMetricHandler=function(){for(var b=g.innerWidth>g.innerHeight?Math.floor((g.innerHeight+a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).scrollTop())/a.A.$("#"+a.vars.templateId+" .vse-video-card").first().height()):Math.floor((g.innerWidth+a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).scrollLeft())/a.A.$("#"+a.vars.templateId+" .vse-video-card").first().width()),c=0;c<Math.min(b,
a.vars.playlist.length);c++)a.vars.playlist[c].impressionRecorded||(a.emitVIPThumbnailImpressionMetric(f.METRIC_WATCH_THUMBNAIL_IMPRESSION,a.vars.playlist[c]),a.vars.playlist[c].impressionRecorded=!0)};this.emitMobileThumbnailImpressionMetricHandler=function(){for(var b=Math.floor((g.innerWidth+a.A.$("#"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+" .a-carousel-viewport").scrollLeft())/a.A.$("#"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+" .vse-video-card").first().width()),
c=0;c<Math.min(b,a.vars.ingressPlaylist.length);c++)a.vars.ingressPlaylist[c].impressionRecorded||(a.emitThumbnailMetric(a.vars.clientPrefix+".thumbnailImpression",c),a.vars.ingressPlaylist[c].impressionRecorded=!0)};this.emitPFOImpressionMetricHandler=function(b,c,f){var g=a.getVideoAsin(),h=a.vars.contentIdProductAsinMap[g];if(h){for(;b<Math.min(c,h.length);b++)h[b][2]||(a.emitPFOImpressionMetric(f,h[b][0],h[b][1]),h[b][2]=!0);a.vars.contentIdProductAsinMap[g]=h}};this.emitPFOImpressionMetricVIPHandler=
function(){var b=g.innerWidth>g.innerHeight?Math.floor((a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselViewportSelector).scrollTop()+g.innerHeight)/a.A.$("#"+a.vars.templateId+" .vse-product-item").first().height()):Math.floor((a.A.$("#"+a.vars.templateId+" "+f.VIPProductCarouselViewportSelector).scrollLeft()+g.innerWidth)/a.A.$("#"+a.vars.templateId+" .vse-product-item").first().width());a.emitPFOImpressionMetricHandler(0,b,f.METRIC_PFO_IMPRESSION)};this.emitPFOImpressionMetricDefaultHandler=
function(b){var c=b.carousel.getAttr("pageNumber");b=b.carousel.getAttr("pageSize");a.emitPFOImpressionMetricHandler((c-1)*b,c*b,f.METRIC_PFO_IMPRESSION)};this.emitPFOImpressionMetricInitHandler=function(b){a.vars.A.off("a:carousel:"+a.vars.relatedProductsCarouselName+":change:pageNumber",a.emitPFOImpressionMetricDefaultHandler);a.vars.A.on("a:carousel:"+a.vars.relatedProductsCarouselName+":change:pageNumber",a.emitPFOImpressionMetricDefaultHandler);a.emitPFOImpressionMetricDefaultHandler(b)};this.emitVIPMultiCarouselImpressionMetricHandler=
function(b){var c=b?"#"+a.vars.templateId+" "+f.VIPMultiCarouselOneContainer:"#"+a.vars.templateId+" "+f.VIPMultiCarouselTwoContainer,c=g.innerWidth>g.innerHeight?Math.floor((g.innerHeight+a.A.$(c+" "+f.VIPLbCarouselViewportSelector).scrollTop())/a.A.$(c+" .vse-video-card").first().height()):Math.floor((g.innerWidth+a.A.$(c+" "+f.VIPLbCarouselViewportSelector).scrollLeft())/a.A.$(c+" .vse-video-card").first().width()),k=0;b||a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||(k=a.vars.multiCarouselS1.getplaylist().length,
c+=k);for(;k<Math.min(c,a.vars.playlist.length);k++)a.vars.playlist[k].impressionRecorded||(a.emitVIPThumbnailImpressionMetric(f.METRIC_WATCH_THUMBNAIL_IMPRESSION,a.vars.playlist[k]),a.vars.playlist[k].impressionRecorded=!0)};this.handleWatchIconMetric=function(){var b=function(b){a.vars.manualTriggerWatchIcon||a.emitClickMetric(f.METRIC_WATCH_ICON);a.vars.useMultiCarousel&&!a.vars.multiCarouselExpanded&&(a.resetUserActivityTimer(-2),setTimeout(function(){return a.openCloseMultiCarousel()},750))};
a.vars.useMultiCarousel||(a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).unbind("scroll"),a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).bind("scroll",a.emitVIPThumbnailImpressionMetricHandler));a.A.$("#"+a.vars.templateId+" "+f.VIPWatchIconSelector+".vse-unpressed").click(b);a.A.$("#"+a.vars.templateId+" "+f.VIPWatchIconSelector+".vse-pressed").click(b)};this.handleShopIconMetric=function(){var b=function(b){a.vars.manualTriggerShopIcon||a.emitClickMetric(f.METRIC_SHOP_ICON)};
a.A.$("#"+a.vars.templateId+" "+f.VIPShopIconSelector+".vse-unpressed").click(b);a.A.$("#"+a.vars.templateId+" "+f.VIPShopIconSelector+".vse-pressed").click(b)};this.handleShareIconMetric=function(){a.A.on("a:sheet:beforeShow:"+a.vars.socialShareId+"-sheet",function(){a.emitClickMetric(f.METRIC_SHARE_ICON)})};this.handleInfluencerProfileNameClick=function(){a.dom.$activeVideoCustomerProfile.find(".a-profile-name").unbind("click");a.dom.$activeVideoCustomerProfile.find(".a-profile-name").click(function(){l.count(a.vars.clientPrefix+
".influencerProfileNameClickCount",1)})};this.handleInfluencerAvatarClick=function(){a.dom.$activeVideoCustomerProfile.find(".a-profile-avatar").unbind("click");a.dom.$activeVideoCustomerProfile.find(".a-profile-avatar").click(function(){l.count(a.vars.clientPrefix+".influencerAvatarClick",1)})};this.getDeviceOrientation=function(){return g.innerHeight>g.innerWidth?f.PORTRAIT:g.innerWidth>g.innerHeight?f.LANDSCAPE:f.SQUARE};this.getAspectRatio=function(a){if(a===f.PORTRAIT)return f.PORTRAIT_ASPECT_RATIO;
if(a===f.LANDSCAPE)return f.LANDSCAPE_ASPECT_RATIO;if(a===f.SQUARE)return f.SQUARE_ASPECT_RATIO};this.isDesktopVerticalLightBox=function(){return!a.vars.isMobile&&g.innerWidth<a.vars.verticalLightBoxMaxWidth};this.attachStickyHeaders=function(){a.vars.isMobile||!a.vars.lightboxOpened||a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.attachStickyHeader({A:a.vars.A,stickyHeaderContainer:"#"+a.vars.popoverId+" .vse-lb-right",stickyHeaderLBContainer:"#"+a.vars.popoverId,
lbModalContainer:".a-modal-scroller.a-declarative"})};this.resetStickyHeaders=function(){a.vars.isMobile||a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.dom.$lbRightColumn.find(".vse-vc-header.first-item").removeAttr("style").removeClass("vse-absolute")};this.initializeVideoActionTray=function(b,c){a.vars.videoActionTrayComponents=new ea({A:a.A,contentCarousel:a.vars.relatedVideosCarousel,socialShareId:a.vars.socialShareId,templateId:a.vars.templateId});a.setVIPOrientationProperties(c);a.handleShopIconMetric();
a.vars.videoActionTrayComponents.handleShopIconInteractions();a.vars.videoActionTrayComponents.handleShareIconInteractions();a.handleShareIconMetric();a.handleWatchIconMetric();a.vars.videoActionTrayComponents.handleVIPCarouselClose();a.initializeWatchComponents(b);a.A.on("vse:"+a.vars.templateId+":vip:vat:component:open",function(){a.A.$("#"+a.vars.templateId+" "+f.VIPActionOverlaySelector).addClass(f.VIPActionOverlayShowClassName)});a.A.on("vse:"+a.vars.templateId+":vip:vat:component:close",function(){a.A.$("#"+
a.vars.templateId+" "+f.VIPActionOverlaySelector).removeClass(f.VIPActionOverlayShowClassName)})};this.initializeVIPControls=function(){var b=a.dom.$wrapper.find(f.VIPSkipBackButtonSelector);b.unbind("click");b.click(function(b){b.stopPropagation();b=a.vars.player.getCurrentTime();a.vars.player.setCurrentTime(b-10);a.resetUserActivityTimer(2);a.vars.isContinuousPlayFinished=!1;a.emitClickMetric(f.METRIC_SKIP_BACK)});b=a.dom.$wrapper.find(f.VIPSkipForwardButtonSelector);b.unbind("click");b.click(function(b){b.stopPropagation();
b=a.vars.player.getCurrentTime();a.vars.player.setCurrentTime(b+15);a.resetUserActivityTimer(2);a.emitClickMetric(f.METRIC_SKIP_FORWARD)});a.vars.vipPlayPauseToggle=a.dom.$wrapper.find(f.VIPPlayPauseToggleSelector);a.vars.vipPlayPauseToggle.unbind("click");a.vars.vipPlayPauseToggle.click(function(b){b.stopPropagation();a.vars.vipControlsShouldPause?(a.pauseVideoIfNeeded(),a.vars.vipControlsShouldPause=!1,a.emitClickMetric(f.METRIC_PAUSE)):(a.vars.useUpNextComponent&&a.vars.isUpNextComponentActive?
a._playUpNextHandler():a.resumeVideoIfNeeded(),a.resetUserActivityTimer(2),a.vars.vipControlsShouldPause=!0,a.emitClickMetric(f.METRIC_PLAY));a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause);a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause)});var c=a.dom.$wrapper.find(f.VIPProgressBarFillSelector),g=a.dom.$wrapper.find(f.VIPProgressBarSelector),k=a.dom.$wrapper.find(f.VIPTimeElapsedSelector),h=a.dom.$wrapper.find(f.VIPTimeRemainingSelector);
a.vars.player.on("timeupdate",function(){if(0===a.vars.vipVideoDuration)a.vars.vipVideoDuration=a.vars.player.getMediaDuration();else{var b=a.vars.player.getCurrentTime(),d=b/a.vars.vipVideoDuration,d=g.width()*d;c.width(d);var d=Math.floor(b%60),e=Math.floor(b/60%60),f=0,m=!1;3600<=a.vars.vipVideoDuration&&(f=Math.floor(b/3600),m=!0);k.text((m?f+":":"")+(m&&10>e?"0"+e+":":e+":")+(10>d?"0"+d:d));b=a.vars.vipVideoDuration-b;d=Math.floor(b%60);e=Math.floor(b/60%60);m&&(f=Math.floor(b/3600));h.text("-"+
(m?f+":":"")+(m&&10>e?"0"+e+":":e+":")+(10>d?"0"+d:d))}});a.dom.$wrapper.delegate(f.VIPProgressBarSelector,"touchstart",function(b){b.stopPropagation();a.vars.isScrubbing=!0;a.pauseVideoIfNeeded()});a.dom.$wrapper.delegate(f.VIPProgressBarSelector,"touchmove",function(b){if(a.vars.isScrubbing){b.stopPropagation();a.resetUserActivityTimer();var c=g.offset().left,d=g.width();b=Math.max(0,Math.min(1,(b.originalEvent.touches[0].pageX-c)/d));c=a.vars.vipVideoDuration*b;1===b&&(c-=.1);a.vars.player.setCurrentTime(c)}});
a.dom.$wrapper.delegate(f.VIPProgressBarSelector,"touchend",function(b){b.stopPropagation();a.vars.isScrubbing=!1;a.resumeVideoIfNeeded()});a.dom.$wrapper.delegate(f.VIPProgressBarSelector,"click",function(b){b.stopPropagation();a.resetUserActivityTimer();var c=g.offset().left,d=g.width();a.vars.player.setCurrentTime(a.vars.vipVideoDuration*Math.max(0,Math.min(1,(b.pageX-c)/d)))})};this.updateSegmentTab=function(b){a.vars.relatedVideosCarousel&&a.vars.relatedVideosCarousel.updateSegmentTabForActiveVideo(b)};
this.emitWidgetClickMetric=function(){var b=a.vars.buildSushiPayload({eventName:a.vars.clientPrefix+".widgetClick",stringPayload:f.EMPTY_STRING,intPayload:1});l.emitSushiMetric(b,a.vars.universalSushiEndpoint)};this.emitThumbnailMetric=function(b,c){b=a.vars.buildSushiPayload({eventName:b,stringPayload:f.EMPTY_STRING,intPayload:c,videoAsin:a.vars.ingressPlaylist[c].contentId});l.emitSushiMetric(b,a.vars.universalSushiEndpoint)};this.emitThumbnailRenderMetric=function(b,c){b=a.vars.buildSushiPayload({eventName:b,
stringPayload:f.EMPTY_STRING,intPayload:c,videoAsinList:a.vars.ingressPlaylist.map(function(a){return a.contentId}).join(",")});l.emitSushiMetric(b,a.vars.universalSushiEndpoint)};this.emitThumbnailMetricOnResize=function(){a.vars.carouselPageSize=a.vars.ingressCarousel.auiCarousel.getAttr("pageSize");a.vars.previousPage=a.vars.ingressCarousel.auiCarousel.getAttr("totalPages");var b=a.vars.ingressCarousel.auiCarousel.getAttr("pageNumber");a.vars.nextPage=b+1;b=a.vars.carouselPageSize*(b-1);a.emitThumbnailImpressionMetric(b,
Math.min(b+a.vars.carouselPageSize,a.vars.ingressPlaylist.length));a.vars.carouselPageSize>=a.vars.ingressPlaylist.length&&(a.vars.A.off("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageSize",a.emitThumbnailMetricOnResize),a.vars.A.off("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageNumber",a.emitThumbnailMetricOnNextPage))};this.emitThumbnailImpressionMetric=function(b,c){for(;b<c;b++)a.vars.ingressPlaylist[b].impressionRecorded||
(a.emitThumbnailMetric(a.vars.clientPrefix+".thumbnailImpression",b),a.vars.ingressPlaylist[b].impressionRecorded=!0)};this.emitThumbnailMetricOnNextPage=function(){var b=a.vars.ingressCarousel.auiCarousel.getAttr("pageNumber"),c=a.vars.carouselPageSize*(b-1),f=Math.min(c+a.vars.carouselPageSize,a.vars.ingressPlaylist.length);b===a.vars.nextPage?(a.emitThumbnailImpressionMetric(c,f),a.vars.nextPage++,f!==a.vars.ingressPlaylist.length&&a.vars.nextPage!==a.vars.previousPage+1||a.vars.A.off("a:carousel:"+
a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageNumber",a.emitThumbnailMetricOnNextPage)):b===a.vars.previousPage&&(a.emitThumbnailImpressionMetric(c,f),a.vars.previousPage--)};this.vseCsmWidgetLoadedMetrics=function(){var b=a.vars.A.$("#"+a.vars.clientPrefix+"-vse-related-videos");if(a.vars.isMetricRecorded||a.vars.A.objectIsEmpty(b.offset()))a.vars.A.off("scroll",a.vseCsmWidgetLoadedMetrics);else if(a.vars.A.onScreen(b)){b=a.vars.A.now()-a.vars.widgetStartTime;a.vars.A.$("#vse-spinner").hasClass("aok-hidden")?
(l.count(a.vars.clientPrefix+".widgetViewedAndLoadedCount",1),l.count(a.vars.clientPrefix+".widgetViewedAndLoadedDuration",b)):(l.count(a.vars.clientPrefix+".widgetViewedNotLoadedCount",1),l.count(a.vars.clientPrefix+".widgetViewedNotLoadedDuration",b));l.count(a.vars.clientPrefix+".pageLoadToWidgetViewedDuration",b);if(a.vars.emitSushiMetric){b=a.vars.buildSushiPayload({eventName:a.vars.clientPrefix+".pageView",stringPayload:f.EMPTY_STRING,intPayload:1});l.emitSushiMetric(b,a.vars.universalSushiEndpoint);
a.vars.carouselPageSize=Math.min(a.vars.ingressCarousel.carouselPageSize,a.vars.ingressPlaylist.length);a.vars.nextPage=a.vars.ingressCarousel.carouselPageNumber+1;a.vars.previousPage=a.vars.ingressCarousel.auiCarousel.getAttr("totalPages");for(b=0;b<a.vars.carouselPageSize;b++)a.emitThumbnailMetric(a.vars.clientPrefix+".thumbnailImpression",b);a.vars.carouselPageSize!=a.vars.ingressPlaylist.length&&(a.vars.isMobile?(a.vars.A.off("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+
":change:pageSize",a.emitMobileThumbnailImpressionMetricHandler),a.vars.A.on("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageSize",a.emitMobileThumbnailImpressionMetricHandler),a.A.$("#"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+" .a-carousel-viewport").unbind(),a.A.$("#"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+" .a-carousel-viewport").bind("scroll",a.emitMobileThumbnailImpressionMetricHandler)):(a.vars.A.on("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+
":change:pageSize",a.emitThumbnailMetricOnResize),a.vars.A.on("a:carousel:"+a.vars.ingressCarousel.contentCarouselConfig.carouselName+":change:pageNumber",a.emitThumbnailMetricOnNextPage)))}a.vars.isMetricRecorded=!0}};this.getModalFactory=function(){var b=null;a.vars.isMobile?q.now("a-secondary-view").execute("vw-dp-secondary-view",function(a){b=a}):q.now("a-modal").execute("vw-dp-modal",function(a){b=a});return b};this.resetVIPControls=function(){a.vars.vipControlsShouldPause||(a.vars.vipControlsShouldPause=
!0,a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause),a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause))};this.requestMshopFullscreen=function(){a.vars.A.objectIsEmpty(a.vars.mShopFactory)||a.vars.mShopFactory.requestFullscreen({successCallback:function(){document.addEventListener("touchmove",a.mShopScrollLock,!0);document.addEventListener("touch",a.mShopScrollLock,!0);a.vars.A.delay(function(){a.vars.A.trigger("resize",
{},{width:g.innerWidth,height:document.documentElement.clientHeight});a.dom.$lbContainer&&a.dom.$lbContainer.height(document.documentElement.clientHeight)},200)},failCallback:function(){a.vars.A.trigger("resize",{},{width:g.innerWidth,height:document.documentElement.clientHeight});a.dom.$lbContainer&&a.dom.$lbContainer.height(document.documentElement.clientHeight)}})};this.cancelMshopFullscreen=function(b){void 0===b&&(b=function(){});a.vars.A.objectIsEmpty(a.vars.mShopFactory)||a.vars.mShopFactory.cancelFullscreen({successCallback:function(){document.removeEventListener("touchmove",
a.mShopScrollLock,!0);document.removeEventListener("touch",a.mShopScrollLock,!0);b()},failCallback:function(){a.requestMshopFullscreen()}})};this.cancelMshopFullscreenAndNavigate=function(b){"string"===typeof b?a.cancelMshopFullscreen(function(){a.vars.A.delay(function(){a.vars.$(".vse-close-button").click();g.location.href=b},600)}):(b.preventDefault(),a.cancelMshopFullscreen(function(){if(b.srcElement){var c=b.srcElement.getAttribute("href");a.vars.$(".vse-close-button").click();g.location.href=
c}}))};this.openExternalLinkFromLightBox=function(b){a.pauseVideoIfNeeded();a.vars.isMshop&&a.vars.isVideoImmersivePlayer&&a.cancelMshopFullscreenAndNavigate(b)};this.mShopScrollLock=function(b){0<a.vars.$(b.target).closest(f.VIPActionOverlaySelector).length||0<a.vars.$(b.target).closest(".vse-profile").length||0<a.vars.$(b.target).closest(".vse-fb-sheet").length||a.vars.$(b.target).hasClass("vse-fb-copyright")||a.vars.$(b.target).hasClass("vse-oap-link")||a.vars.$(b.target).hasClass("vse-profile")||
a.vars.$(b.target).hasClass("vse-cr-link")?b.stopPropagation():b.preventDefault()};this.initializeWatchComponents=function(b){b={A:a.A,segmentTabs:b,segmentTabCssClassSelectorName:"#"+a.vars.popoverId+" "+f.VIPLbTabsContainerSelector+" .vse-vip-lb-tab"};a.vars.useMultiCarousel?a.vars.useMultiCarousel&&!a.vars.hideWatchIcon&&a.vars.videoActionTrayComponents.handleMoreVideosIconInteractions():(a.vars.relatedVideosCarousel.initializeSegmentTabs(b),a.vars.videoActionTrayComponents.handleWatchIconInteractions())};
this.setVIPOrientationProperties=function(b){var c={carouselAnimationType:{width:"toggle"},getCardInViewOffset:function(a){return a.offset().left},getOffsetPointForTabUpdate:function(){return g.innerWidth/2},animatedCarouselDimensionValue:function(){return b},getCarouselPropertyToAnimate:function(a){return{scrollLeft:a}}},k={carouselAnimationType:{height:"toggle"},getCardInViewOffset:function(a){return a.offset().top},getOffsetPointForTabUpdate:function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0)+
parseInt(a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:first").css("margin-top"))},animatedCarouselDimensionValue:function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:last").outerHeight(!0)+3},getCarouselPropertyToAnimate:function(a){return{scrollTop:a}}},l={carouselAnimationType:{height:"toggle"},getCardInViewOffset:function(a){return a.offset().top},getOffsetPointForTabUpdate:function(){return a.A.$("#"+a.vars.templateId+" "+f.VIPLbTabsContainerSelector).outerHeight(!0)+
parseInt(a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselSelector+" .vse-video-card:first").css("margin-top"))},animatedCarouselDimensionValue:function(){return b},getCarouselPropertyToAnimate:function(a){return{scrollLeft:a}}};g.innerHeight>g.innerWidth&&a.setOrintationConfig(c);g.innerWidth>g.innerHeight&&(a.vars.useMultiCarousel?a.setOrintationConfig(l):a.setOrintationConfig(k),a.updateLbViewportHeight());a.A.on.orientationchange(function(b){0===b.orientation?(a.setOrintationConfig(c),a.resetLbViewportHeight()):
(a.vars.useMultiCarousel?a.setOrintationConfig(l):a.setOrintationConfig(k),a.updateLbViewportHeight())})};this.setOrintationConfig=function(b){a.vars.videoActionTrayComponents.setOrientationConfig(b);a.setOrientationConfig(b)};this.resetLbViewportHeight=function(){a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).css("height","initial")};this.updateLbViewportHeight=function(){a.A.$("#"+a.vars.templateId+" "+f.VIPLbCarouselViewportSelector).height(g.innerHeight-a.A.$("#"+a.vars.templateId+
" "+f.VIPLbTabsContainerSelector).outerHeight(!0))};this.showReviewsExpandButton=function(){var b=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper").prop("scrollHeight"),c=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper").prop("clientHeight");b>c&&a.A.$("#"+a.vars.templateId+" .vse-reviews-expand").css("visibility","visible")};this.styleExpandedReviewText=function(){var b=a.A.$("#"+a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper"),c=b.prop("scrollHeight"),
f=b.prop("clientHeight"),g=b.prop("scrollTop");c-g===f?b.addClass("vse-reviews-content-ellipsis-wrapper-short"):b.addClass("vse-reviews-content-ellipsis-wrapper-long")};this.styleCollapsedReviewText=function(){a.A.$("#"+a.vars.templateId+" .vse-reviews-content-ellipsis-wrapper").removeClass("vse-reviews-content-ellipsis-wrapper-short vse-reviews-content-ellipsis-wrapper-long")};this.toggleVipPlayPauseClass=function(){a.vars.vipPlayPauseToggle.toggleClass(f.VIPPauseIconClassName,a.vars.vipControlsShouldPause);
a.vars.vipPlayPauseToggle.toggleClass(f.VIPPlayIconClassName,!a.vars.vipControlsShouldPause)};this.handleKeepVideoCarouselOpen=function(){a.vars.lightboxOpened&&a.vars.keepCarouselOpenOnLinkClick&&(a.handleIVXOverlay(),a.vars.manualTriggerWatchIcon=!0,a.vars.videoActionTrayComponents.triggerWatchIconInteractionOpen(),a.vars.watchAllClicked=!1,a.vars.manualTriggerWatchIcon=!1)};this.handleKeepProductCarouselOpen=function(){a.vars.lightboxOpened&&a.vars.keepProductCarouselOpenOnClick&&(a.handleIVXOverlay(),
a.vars.manualTriggerShopIcon=!0,a.vars.videoActionTrayComponents.triggerShopIconInteractionOpen(),a.vars.manualTriggerShopIcon=!1)};this.handleIVXOverlay=function(){a.vars.useAutoplayFallback||!a.vars.lightboxOpenedFirstTime?a.showVideoImmersivePlayerOverlay():a.hideVideoImmersivePlayerOverlay()};this.showPoster=function(b){a.vars.player.showPoster(b)};this.addPlayerHoverHandler=function(){var b=a.vars.A.$("#"+a.vars.containerId),c=a.vars.$("#"+a.vars.templateId+"-close-button");if(c){c=c.clone();
c.removeClass("vse-close-button").addClass(f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME);b.append(c);var g=function(){(a.isDesktopVerticalLightBox()||a.isSingleVideoLightbox())&&a.toggleLightboxCloseButton(!0)};b.hover(function(){return g()},function(){(a.isDesktopVerticalLightBox()||a.isSingleVideoLightbox())&&a.toggleLightboxCloseButton(!1)});a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).hover(function(){g();a.vars.isFeedbackClosed&&a.showFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer)})}};
this.toggleLightboxCloseButton=function(b){0<a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).length&&a.dom.$wrapper.find("."+f.LB_CLOSE_BUTTON_ON_PLAYER_CLASS_NAME).toggleClass("vse-show",b)};this.feedBackMouseLeaveHandler=function(){a.vars.isFeedbackClosed?a.hideFeedbackLink(a.vars.feedbackContainer,a.vars.playerContainer):a.toggleLightboxCloseButton(!0);a.vars.cursorOnVideoPlayerDiv=!1};this.isSingleVideoLightbox=function(){return 0<a.vars.A.$("#"+a.vars.popoverName+"-wrapper").length?
0<=a.vars.A.$("#"+a.vars.popoverName+"-wrapper").attr("data-css-class").indexOf("vse-single-video-lb"):!1};this.showHideElementsForMultiCarousel=function(){a.vars.multiCarouselExpanded?setTimeout(function(){a.A.$("#"+a.vars.templateId+" ."+f.VIPScrubberClassName).removeClass("aok-hidden");a.A.$("#"+a.vars.templateId+" ."+f.VIPPlayPauseClassName).removeClass("aok-hidden");a.A.$("#"+a.vars.templateId+" "+f.VIPFeedbackContainer).removeClass("aok-hidden");a.A.$("#"+a.vars.templateId+" ."+f.VIPVideoHelpfulVotesClassName).removeClass("aok-hidden")},
250):(a.A.$("#"+a.vars.templateId+" ."+f.VIPScrubberClassName).addClass("aok-hidden"),a.A.$("#"+a.vars.templateId+" ."+f.VIPPlayPauseClassName).addClass("aok-hidden"),a.A.$("#"+a.vars.templateId+" "+f.VIPFeedbackContainer).addClass("aok-hidden"),a.A.$("#"+a.vars.templateId+" ."+f.VIPVideoHelpfulVotesClassName).addClass("aok-hidden"))};this.openCloseMultiCarousel=function(){a.vars.multiCarouselExpanded?(a.vars.hideWatchIcon||a.vars.videoActionTrayComponents.reset(),a.A.$("#"+a.vars.templateId+" "+
f.VIPMultiCarouselWrapper).removeClass(f.VIPMultiCarouselExpandedClass),a.showHideElementsForMultiCarousel(),a.resetUserActivityTimer(),a.vars.multiCarouselExpanded=!1,a.vars.keepMultiCarouselOpen=!1):(a.resetUserActivityTimer(-2),a.A.$("#"+a.vars.templateId+" "+f.VIPMultiCarouselWrapper).addClass(f.VIPMultiCarouselExpandedClass),a.showHideElementsForMultiCarousel(),a.vars.multiCarouselExpanded=!0)};this.isGroupOne=function(b){if(b.groupType)return-1!==b.groupType.indexOf(f.G1);if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1))for(var c=
a.vars.multiCarouselS1.getplaylist(),g=0;g<c.length;g++)if(c[g].contentId===b.contentId)return!0;return!1};this.getActiveAsset=function(){if(a.vars.useMultiCarousel){var b,c=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:a.isGroupOne(a.vars.currentAssetSpec);c&&!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)?b=a.vars.multiCarouselS1.getActiveAsset():c||a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||(b=a.vars.multiCarouselS2.getActiveAsset());return b}return a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)?
a.vars.currentAssetSpec:a.vars.relatedVideosCarousel.getActiveAsset()};this.getCombinedPlaylist=function(){if(a.vars.useMultiCarousel){var b=[];a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||(b=b.concat(a.vars.multiCarouselS1.getplaylist()));a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||(b=b.concat(a.vars.multiCarouselS2.getplaylist()));return b}return a.vars.relatedVideosCarousel.getplaylist()};this.setOrientationConfig=function(b){a.vars.useMultiCarousel?(a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||
a.vars.multiCarouselS1.setOrientationConfig(b),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.setOrientationConfig(b)):a.vars.relatedVideosCarousel.setOrientationConfig(b)};this.findIndex=function(b){if(a.vars.useMultiCarousel){var c=a.isGroupOne(b);if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&c)return a.vars.multiCarouselS1.findIndex(b);if(!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)&&!c)return(a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)?0:a.vars.multiCarouselS1.getplaylist().length)+
a.vars.multiCarouselS2.findIndex(b)}else return a.vars.relatedVideosCarousel.findIndex(b)};this.markPlaying=function(b){if(a.vars.useMultiCarousel){var c=a.isGroupOne(b),g=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:a.isGroupOne(a.vars.currentAssetSpec);!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&c?(a.vars.multiCarouselS1.markPlaying(b),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||g||a.dom.$wrapper.find(f.VIPMultiCarouselTwoContainer).find(".vse-video-card").removeClass("active")):
a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||(a.vars.multiCarouselS2.markPlaying(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&g&&a.dom.$wrapper.find(f.VIPMultiCarouselOneContainer).find(".vse-video-card").removeClass("active"))}else a.vars.relatedVideosCarousel.markPlaying(b)};this.rotateTo=function(b){if(a.vars.useMultiCarousel){var c=a.isGroupOne(b),f=a.vars.A.objectIsEmpty(a.vars.currentAssetSpec)?!1:a.isGroupOne(a.vars.currentAssetSpec);!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&
c?(a.vars.multiCarouselS1.rotateTo(b),a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||f||a.vars.multiCarouselS2.removeActive()):a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||(a.vars.multiCarouselS2.rotateTo(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&f&&a.vars.multiCarouselS1.removeActive())}else a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.rotateTo(b)};this.updateVotingElements=function(b,c,f){a.vars.useMultiCarousel?(b=a.isGroupOne(b),!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)&&
b?a.vars.multiCarouselS1.updateVotingElements(c,f):a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)||a.vars.multiCarouselS2.updateVotingElements(c,f)):a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||a.vars.relatedVideosCarousel.updateVotingElements(c,f)};this.initializeMultiCarousel=function(b,c){a.emitRelatedVideosRenderMetric(f.METRIC_WATCH_THUMBNAIL_RENDER,c);c=b?f.VIPMultiCarouselOneContainer:f.VIPMultiCarouselTwoContainer;a.dom.$wrapper.delegate(c,"touchstart",function(b){a.vars.multiCarouselExpanded&&
(a.vars.keepMultiCarouselOpen=!0,a.resetUserActivityTimer(-2),b.stopPropagation())});a.dom.$wrapper.delegate(c,"touchend",function(c){a.vars.multiCarouselExpanded&&(a.vars.keepMultiCarouselOpen=!1,a.emitVIPMultiCarouselImpressionMetricHandler(b),a.resetUserActivityTimer(-2),c.stopPropagation())})};this.relatedVideosCarouselNotEmpty=function(){return!a.vars.A.objectIsEmpty(a.vars.relatedVideosCarousel)||!a.vars.A.objectIsEmpty(a.vars.multiCarouselS1)||!a.vars.A.objectIsEmpty(a.vars.multiCarouselS2)};
this.vars={A:b,$:b.$,isMobile:!1,player:null,feedback:null,clientPrefix:null,placement:null,containerId:null,contentId:null,productAsin:null,playerFactory:null,ingressRelatedVideosCarousel:null,relatedVideosCarousel:null,keepCarouselOpenOnLinkClick:!1,watchAllClicked:!1,keepProductCarouselOpenOnClick:!1,videoVoteContainerFactory:null,activeVideoVoteContainer:null,isMshop:!1,isContinuousPlayFinished:!1,isFeedbackClosed:!0,showVotes:!1,videoVoteFailure:!1,videoVoteConfig:null,currentAssetSpec:null,
initialVideo:null,relatedProductsNilgiriRequestCount:0,popoverId:null,relatedProductsRequest:null,cursorOnVideoPlayerDiv:!1,lightBoxPausedVideo:!1,verticalLightBoxMaxWidth:1024,relatedProductsContainerFixedHeight:115,currentIndex:0,socialSharePageState:null,buildSushiPayload:null,mShopFactory:null,lightboxOpened:!1,lightboxCarouselRegistered:!1,playFullScreenVideo:!1,ingressHasInitialAssetSpec:!0,playlist:null,isVideoImmersivePlayer:!1,secondsFromLastActivity:0,intervalUserActivityHandlerId:0,isVIPOverlayTimerSet:!1,
lightboxOpenedFirstTime:!0,videoActionTrayComponents:null,socialShareId:null,ingressCarousel:null,ingressPlaylist:null,sushiMetricsConfig:null,universalSushiEndpoint:f.EMPTY_STRING,widgetStartTime:0,isMetricRecorded:!1,carouselPageSize:0,nextPage:0,previousPage:0,emitSushiMetric:!1,vipVideoDuration:0,isScrubbing:!1,vipControlsShouldPause:!0,vipPlayPauseToggle:null,shouldShowProfiles:!1,popoverName:null,isUpNextComponentActive:!1,upNextTimeoutHandle:null,useUpNextComponent:!1,upNextString:f.EMPTY_STRING,
cancelString:f.EMPTY_STRING,watchIconFirstOpen:!0,shopIconFirstOpen:!0,manualTriggerWatchIcon:!1,manualTriggerShopIcon:!1,showClosedCaptions:!1,customerReviewsConfig:null,useAutoplayFallback:!1,vipPlayIconClicked:!1,contentIdProductAsinMap:{},showLightboxV2Experience:!1,playerContainer:null,feedbackContainer:null,showContentCarousel:!0,useMultiCarousel:!1,hideWatchIcon:!1,multiCarouselExpanded:!1,handleMultiCarousel:!0,keepMultiCarouselOpen:!1,multiCarouselS1:null,multiCarouselS2:null,isSwipingMultiCarousel:!1};
this.dom={$wrapper:null,$lbContainer:null,$lbLeftColumn:null,$lbRightColumn:null,$lbCCHeader:null,$lbTabContainer:null,$videoAuthor:null,$playerContainer:null,$mobileFixedContainer:null,$mobileMovableContainer:null,$relatedProductContainer:null,$activeVideoOspLink:null,$activeVideoTitlePrefix:null,$activeVideoCRLink:null,$lbVideoCarousel:null,$activeVideoCustomerProfile:null,$customerProfileContainer:null,$videoAuthorBlock:null,$activeVideoCRLinkWrapper:null,$profileLinkSelector:null};this.refTagRecorder=
new B(b)}c.prototype.isCustomerReviewVideo=function(b){return"AOD60"==b.vendorCode};c.prototype.isInfluencerVideo=function(b){return b.creatorType?"influencer"===b.creatorType.toLowerCase():!1};return c}(),fa=f.VAP_EW+"subcomponent/",ga=function(){function c(){}c.getLazyLoadComponents=function(b,a,d,f,g){b.$("#"+a+" div[data-configuration]").each(function(){c.callSubComponentBuilder({A:b,context:d,handleFailure:g,handleSuccess:f},b.$(this),3)})};c.callSubComponentBuilder=function(b,a,d){var f=b.A,
g=b.context,k=b.handleFailure,h=b.handleSuccess,n=atob(a.attr("data-configuration")),q=JSON.parse(n),n=d,e={pageContext:g,configuration:q},x=f.now();d--;var m=n-d-1;y.sendRequest(f,fa+q.type,e,function(b){var c=f.now()-x;l.count("vse_component_lazyLoaderHook:success:",c);l.count("vse_component_lazyLoaderHook:success:"+g.page+":"+g.placement+":"+q.type+":"+m,1);a.html(b);h(f,e)},function(h){(0===h.http.status||500<=h.http.status&&599>=h.http.status)&&0<d?(l.count("vse_component_lazyLoaderHook:error:"+
g.page+":"+g.placement+":"+q.type+":"+m,1),c.callSubComponentBuilder(b,a,d)):(l.count("vse_component_lazyLoaderHook:failure",1),k(f,e))})};return c}();try{var ha=function(c){return new c(function(b,a){q.when("A","a-carousel-framework","a-carousel-constants","3p-promise","a-button","ready").register("VSEComponentAssets",function(a,c,k,t,h){return{setClientPrefix:function(b,p){var e=new V(a);e.vars.clientPrefix=b;e.vars.templateId=p.templateId;e.vars.showLightboxV2Experience=p.showLightboxV2Experience||
!1;e.vars.isMobile=a.capabilities.mobile;e.vars.A.objectIsEmpty(p)||(p.hasOwnProperty(f.IS_VIDEO_IMMERSIVE_PLAYER_KEY)&&(e.vars.isVideoImmersivePlayer=p.isVideoImmersivePlayer),p.hasOwnProperty(f.SHOW_CONTENT_CAROUSEL)&&(e.vars.showContentCarousel=p.showContentCarousel));a.off("vse:ns:player:"+e.vars.clientPrefix+":init");a.off("vse:ns:metadata:"+e.vars.clientPrefix+":init");a.off("vse:ns:socialShare:"+e.vars.clientPrefix+":init");a.off("vse:ns:feedback:"+e.vars.clientPrefix+":init");a.off("vse:ns:relatedVideos:"+
e.vars.clientPrefix+":init");a.off("vse:ns:ingressCarousel:"+e.vars.clientPrefix+":init");a.off("vse:"+e.vars.clientPrefix+":page:lightBoxOpened");a.off("vse:"+e.vars.clientPrefix+":page:lightBoxClosed");a.off("vse:"+e.vars.clientPrefix+":lazyload:relatedvideos:succeeded");a.off("vse:"+e.vars.clientPrefix+":page:watchAllClicked");q.when("mash").execute("VSEComponentAsset-Mash-Detection",function(a){e.vars.isMshop=!0;e.vars.mShopFactory=a});a.on("vse:ns:player:"+e.vars.clientPrefix+":init",function(c){try{var g=
w.fetchLatestPageState(a,c);if(g){var h=g.awaConfig;e.vars.isMobile=g.isMobile;e.vars.productAsin=g.productAsin;e.vars.playFullScreenVideo=g.enableFullScreenByDefault;e.vars.contentId=h.initialVideo;e.vars.containerId=h.containerId;e.vars.placement=h.sushiMetricsConfig.placementContext;e.vars.sushiMetricsConfig=h.sushiMetricsConfig;e.vars.useUpNextComponent=h.useUpNextComponent;e.vars.useAutoplayFallback=h.useAutoplayFallback;e.vars.useUpNextComponent&&(e.vars.upNextString=g.upNextString?g.upNextString:
"UP NEXT",e.vars.cancelString=g.cancelString?g.cancelString:"CANCEL");c={gatedP:z,EventEmitter:F,promise:t};var k={videoUrl:g.videoUrl,contentId:e.vars.contentId,vendorCode:g.vendorCode,vendorTrackingId:g.vendorTrackingId,productAsin:g.productAsin,videoReferenceId:g.videoReferenceId,eventTimestamp:e.vars.A.now(),imageUrl:g.imageUrl,duration:0,refTag:f.EMPTY_STRING};e.setVideoDetails(e.vars.contentId,g);e.vars.showClosedCaptions=g.showClosedCaptions||!1;if(e.vars.showClosedCaptions){var r=g.initialClosedCaptions;
e.vars.A.objectIsEmpty(r)||e.setInitialClosedCaptions(k,r);e.vars.isVideoImmersivePlayer&&e.setupVIPClosedCaptions(g.closedCaptionsConfig,r)}h.initialVideo=k;e.vars.playerFactory=new N(c);e.vars.player=e.vars.playerFactory.create(h);!e.vars.isVideoImmersivePlayer&&e.vars.playFullScreenVideo&&(e.vars.player.aspectRatio(e.getAspectRatio(e.getDeviceOrientation())),e.vars.player.fluid(!1));e.vars.isVideoImmersivePlayer&&(e.vars.player.on("playerClick",e.onPlayerTapHandler),e.vars.useAutoplayFallback&&
(e.vars.player.on("autoplayFailed",e._playerFailedAutoplayHandler),e.vars.player.on("autoplaySucceeded",e._playerSucceededAutoplayHandler)));e.vars.A.trigger("vsePlayer-"+e.vars.clientPrefix,{player:e.vars.player,containerId:e.vars.containerId});e.vars.A.trigger(e.vars.clientPrefix+":vse:player:registered")}else l.count(f.PLAYER_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-player-"+c+"-initialization-failed")}catch(q){l.logFatal(f.ATTRIBUTION_NAME+
":"+e.vars.clientPrefix,"Fatal during player initialization.",q),l.count(b+".playerInitializationFatal",1)}});a.on("vse:ns:metadata:"+e.vars.clientPrefix+":init",function(c){try{var g=w.fetchLatestPageState(a,c);g?(e.vars.videoVoteConfig=g.videoVoteConfig,e.vars.videoVoteConfig=a.$.extend({},e.vars.videoVoteConfig),c={gatedP:z,promise:t},e.vars.videoVoteConfig.hasOwnProperty("placementContext")&&(e.vars.videoVoteConfig.dependencies=c,e.vars.videoVoteContainerFactory=new R(a,e.vars.videoVoteConfig),
e.vars.activeVideoVoteContainer=e.vars.videoVoteContainerFactory.createFromSelector("#vse-video-votes-lb-details-"+e.vars.videoVoteConfig.placementContext)),g.sushiMetricsConfig&&(e.vars.sushiMetricsConfig=g.sushiMetricsConfig,e.vars.buildSushiPayload=I.makeApplicationSushiPayloadBuilder(e.vars.A,e.vars.sushiMetricsConfig),e.vars.emitSushiMetric=!0,e.vars.universalSushiEndpoint=e.vars.sushiMetricsConfig.endpoint,e.vars.A.trigger(e.vars.clientPrefix+":vse:sushiMetrics",{endpoint:e.vars.universalSushiEndpoint,
sushiMetricsConfig:e.vars.sushiMetricsConfig,buildSushiPayload:e.vars.buildSushiPayload,postMetric:l})),g.customerReviewConfig&&(e.vars.customerReviewsConfig=g.customerReviewConfig,e.vars.customerReviewsConfig.showCustomerReviewMetadata&&(e.vars.A.delay(e.showReviewsExpandButton,250),e.attachReviewsPlayerEventListeners(),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-expand-review-content:click"),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-expand-review-content:touch"),e.vars.A.declarative(e.vars.clientPrefix+
"-expand-review-content","click touch",function(a){e.vars.$(f.VIPOverlaySelector).addClass("vse-reviews-expand-full-cr");e.styleExpandedReviewText();e.vars.vipControlsShouldPause&&(e.pauseVideoIfNeeded(),e.vars.vipControlsShouldPause=!1,e.toggleVipPlayPauseClass())}),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-collapse-review-content:click"),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-collapse-review-content:touch"),e.vars.A.declarative(e.vars.clientPrefix+"-collapse-review-content",
"click touch",function(a){e.vars.$(f.VIPOverlaySelector).removeClass("vse-reviews-expand-full-cr");e.vars.$(".vse-reviews-content-ellipsis-wrapper").scrollTop(0);e.styleCollapsedReviewText();e.vars.vipControlsShouldPause||(e.resumeVideoIfNeeded(),e.vars.vipControlsShouldPause=!0,e.toggleVipPlayPauseClass())}))),e.vars.A.trigger(e.vars.clientPrefix+":vse:metadata:registered")):(l.count(f.METADATA_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-metadata-"+
c+"-initialization-failed"))}catch(h){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during metadata initialization.",h),l.count(b+".metadataInitializationFatal",1)}});a.on("vse:ns:socialShare:"+e.vars.clientPrefix+":init",function(c){try{var g=w.fetchLatestPageState(a,c);g?(e.vars.socialSharePageState=c,e.vars.socialShareId=g.id,e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-social-share-mshop-action:click"),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-social-share-mshop-action:touch"),
e.vars.A.declarative(e.vars.clientPrefix+"-social-share-mshop-action","click touch",function(a){e.vars.isMshop&&!e.vars.A.objectIsEmpty(e.vars.mShopFactory)&&(a=e.getActiveAsset(),a=e.getMshopShareParams(a),e.vars.mShopFactory.share(a))}),e.vars.isMobile||(a.off("a:popover:afterShow:"+e.vars.socialShareId+"-popover"),a.on("a:popover:afterShow:"+e.vars.socialShareId+"-popover",function(){e.emitClickMetric(f.METRIC_SHARE_ICON)})),e.vars.A.off("a:declarative:"+e.vars.clientPrefix+"-swf-share-network:click"),
e.vars.A.declarative(e.vars.clientPrefix+"-swf-share-network","click",function(a){a=a.data;var b=e.vars.A.state(e.vars.socialSharePageState);X.share(b,a.network);l.count(f.socialShareClickMetricName,1);e.emitClickMetric(f.METRIC_SHARE_SELECTION_CLICK)}),e.vars.A.trigger(e.vars.clientPrefix+":vse:socialShare:registered")):(l.count(f.SOCIAL_SHARE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-social-share-"+c+"-initialization-failed"))}catch(h){l.logFatal(f.ATTRIBUTION_NAME+
":"+e.vars.clientPrefix,"Fatal during socialShare initialization.",h),l.count(b+".socialShareInitializationFatal",1)}});a.on("vse:ns:feedback:"+e.vars.clientPrefix+":init",function(a){try{var c=w.fetchLatestPageState(e.vars.A,a);if(c){var d=c.id;e.vars.playerContainer="#"+e.vars.containerId+"-container";e.vars.feedbackContainer="#vse-"+e.vars.clientPrefix+"-feedback-container";e.vars.cursorOnVideoPlayerDiv=!1;e.deRegisterFeedback(d);e.vars.A.on("vse:"+d+":feedback:shown",function(){e.pauseVideoIfNeeded();
e.vars.isFeedbackClosed=!1;e.vars.$(".vse-fb-copyright").click(function(a){e.vars.isMshop&&e.vars.isVideoImmersivePlayer&&(e.vars.feedback.hideFeedbackForm(),e.openExternalLinkFromLightBox(a))});e.emitClickMetric(f.METRIC_REPORT_CLICK)});e.vars.A.off("vse:"+d+":feedback:submitted:success");e.vars.A.on("vse:"+d+":feedback:submitted:success",function(){e.emitClickMetric(f.METRIC_REPORT_SUBMIT)});e.vars.A.on("vse:"+d+":feedback:hidden",function(){e.vars.vipControlsShouldPause&&e.resumeVideoIfNeeded();
e.vars.isFeedbackClosed=!0;e.vars.cursorOnVideoPlayerDiv||e.hideFeedbackLink(e.vars.feedbackContainer,e.vars.playerContainer);e.vars.$(".vse-fb-copyright").unbind("click");e.vars.isMshop&&e.vars.mShopFactory&&e.vars.A.delay(function(){e.vars.mShopFactory.dispatchEvent({type:"appOverlays.Hide"})},500)});var g=new Z({A:e.vars.A,buttonApi:h});e.vars.feedback=g.create(d,a);e.updateFeedback(e.vars.currentAssetSpec);e.vars.isFeedbackClosed=!0;var k=e.vars.A.$(e.vars.feedbackContainer);e.vars.A.$(e.vars.playerContainer).append(k);
e.vars.isVideoImmersivePlayer||(e.vars.A.declarative.create(e.vars.$(e.vars.playerContainer),"feedback-overlays-player",{}),e.vars.A.declarative("feedback-overlays-player","mouseenter touchstart focus",function(){e.vars.isFeedbackClosed&&e.showFeedbackLink(e.vars.feedbackContainer,e.vars.playerContainer);e.vars.cursorOnVideoPlayerDiv=!0;e.vars.A.capabilities.touch&&e.vars.A.delay(e.feedBackMouseLeaveHandler,3E3)}),e.vars.A.declarative("feedback-overlays-player","mouseleave",e.feedBackMouseLeaveHandler));
e.vars.A.trigger(e.vars.clientPrefix+":vse:feedback:registered")}else l.count(f.FEEDBACK_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-feedback-"+a+"-initialization-failed")}catch(r){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during feedback initialization.",r),l.count(b+".feedbackInitializationFatal",1)}});a.on("vse:ns:relatedVideos:"+e.vars.clientPrefix+":init",function(h){try{var m=w.fetchLatestPageState(a,h);if(m){var q=new G(c,
k,a,{gatedP:z,promise:t});e.vars.useMultiCarousel=m.useMultiCarousel;e.vars.hideWatchIcon=m.hideWatchIcon;c.createAll();c.initializeAll();e.vars.useMultiCarousel?(-1!==m.carouselName.indexOf("-G2")?(e.vars.multiCarouselS2=q.create(m),e.initializeMultiCarousel(!1,e.vars.multiCarouselS2)):(e.vars.multiCarouselS1=q.create(m),e.initializeMultiCarousel(!0,e.vars.multiCarouselS1)),e.vars.A.objectIsEmpty(e.vars.multiCarouselS1)||e.vars.A.objectIsEmpty(e.vars.multiCarouselS2)||e.vars.A.$("#"+e.vars.templateId+
" "+f.VIPMultiCarouselWrapper).addClass("vse-vip-two-carousels"),e.vars.handleMultiCarousel&&(e.dom.$wrapper.delegate(f.VIPMultiCarouselWrapper,"touchstart",function(a){e.vars.keepMultiCarouselOpen||(a.stopPropagation(),a.preventDefault(),e.openCloseMultiCarousel())}),e.vars.handleMultiCarousel=!1)):e.vars.relatedVideosCarousel=q.create(m);e.vars.A.on("vse:contentCarousel:"+m.carouselName+":click",function(a){e.vars.A.objectIsEmpty(e.vars.player)||(e.vars.player.play(a),e.vars.currentIndex=e.findIndex(a),
e.show(a),e.vars.currentAssetSpec=a,e.vars.showLightboxV2Experience&&e.resizeLB(),e.vars.useMultiCarousel&&e.vars.multiCarouselExpanded&&e.openCloseMultiCarousel(),e.vars.isVideoImmersivePlayer&&(e.vars.isUpNextComponentActive&&e.removeUpNextComponent(),e.vars.videoActionTrayComponents.updateActiveVideoContentId(a),e.resetUserActivityTimer(),e.showVideoImmersivePlayerOverlay(),e.vars.isVIPOverlayTimerSet||(e.vars.intervalUserActivityHandlerId=e.userActivityCountDown()),e.vars.videoActionTrayComponents.reset(),
e.emitClickMetric(f.METRIC_WATCH_THUMBNAIL_CLICK)))});e.isImageBlockVIP()&&(e.vars.currentIndex=e.findIndex(e.vars.currentAssetSpec));var p=e.getCurrentlyPlayingVideoInCarouselMarkAsPlaying(e.vars.currentIndex);e.updateVideoMetadataIfNeeded(p);e.markPlaying(p);e.vars.initialVideo=p;e.vars.showVotes=e.shouldShowVotes(p);e.initializeHelpfulVotes();e.createContinuousPlayPlaylist(p);e.attachPlayerEventListeners();e.updateFeedback(p);e.refreshSocialSharePageState(p);e.vars.isVideoImmersivePlayer?(!e.vars.A.objectIsEmpty(e.vars.videoActionTrayComponents)&&
e.vars.useMultiCarousel||e.initializeVideoActionTray(m.segmentTabs,m.carouselCardWidth),e.updateSegmentTab(p),e.vars.videoActionTrayComponents.updateActiveVideoContentId(p.contentId),e.emitRelatedVideosRenderMetric(f.METRIC_WATCH_THUMBNAIL_RENDER,e.vars.relatedVideosCarousel),e.vars.keepCarouselOpenOnLinkClick=m.keepCarouselOpenOnLinkClick,e.vars.watchAllClicked?e.handleKeepVideoCarouselOpen():e.handleKeepProductCarouselOpen()):e.attachStickyHeaders();e.vars.shouldShowProfiles=m.includeProfiles;e.vars.shouldShowProfiles&&
(e.getCustomerProfileDomElements(),e.isCustomerReviewVideo(p)&&e.updateCustomerProfile(p),e.isInfluencerVideo(p)&&e.updateInfluencerProfile(p),e.dom.$activeVideoCustomerProfile.delegate(".vse-profile","click",function(a){a=e.vars.$(a.target).closest("."+f.VIPVideoInfoClassName).find(".vse-profile").attr("href");e.openExternalLinkFromLightBox(a)}),e.dom.$activeVideoCustomerProfile.delegate(".vse-link","click",function(a){a=e.vars.$(a.target).closest("."+f.VIPVideoInfoClassName).find(".vse-link").attr("href");
e.openExternalLinkFromLightBox(a)}),a.trigger("resize",{},{width:g.innerWidth,height:g.innerHeight}));e.vars.lightboxCarouselRegistered=!0;e.vars.A.trigger(e.vars.clientPrefix+":vse:relatedVideos:registered")}else e.vars.showVotes=!1,l.count(f.RV_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-carousel-"+h+"-initialization-failed")}catch(u){l.logFatal(f.ATTRIBUTION_NAME+":"+e.vars.clientPrefix,"Fatal during Lightbox carousel initialization.",u),l.count(b+
".lightboxCarouselInitializationFatal",1)}});a.on("vse:"+e.vars.clientPrefix+":page:watchAllClicked",function(){e.vars.watchAllClicked=!0});a.on("vse:ns:ingressCarousel:"+e.vars.clientPrefix+":init",function(g,h){try{e.vars.widgetStartTime=h;var p=a.now(),q=w.fetchLatestPageState(a,g);if(q){e.vars.popoverName=q.lightboxPopoverConfig.popoverId;var u=e.vars.popoverName+"-trigger",v=e.vars.popoverName+"-wrapper",y=new G(c,k,a,{gatedP:z,EventEmitter:F,promise:t});e.vars.ingressCarousel=y.create(q);if(e.vars.A.objectIsEmpty(e.vars.ingressCarousel))throw new E("Cannot create Ingress Carousel. Carousel is null or undefined");
e.vars.ingressPlaylist=e.vars.ingressCarousel.getplaylist();e.vars.A.on(e.vars.A.constants.BROWSER_EVENTS.SCROLL,e.vseCsmWidgetLoadedMetrics);e.vseCsmWidgetLoadedMetrics();e.vars.modalFactory=e.getModalFactory();a.on("vse:contentCarousel:"+q.carouselName+":click",function(b){var c=e.vars.modalFactory&&e.vars.modalFactory.get(e.vars.$("#"+u));l.count(""+e.vars.clientPrefix+f.METRIC_WIDGET_CLICK,1);c?(c.show(),a.off("a:popover:afterShow:"+e.vars.popoverName),a.on("a:popover:afterShow:"+e.vars.popoverName,
function(c){a.$(c.popover.$popover).addClass(a.$("#"+v).data("cssClass"));a.trigger("vse:"+e.vars.clientPrefix+":page:lightBoxOpened",{assetSpec:b,lightBoxId:v})}),e.vars.emitSushiMetric&&e.emitWidgetClickMetric()):l.count(f.LB_POPOVER_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1)});a.on("a:popover:beforeHide:"+e.vars.popoverName,function(){a.objectIsEmpty(e.vars.ingressCarousel)||e.vars.ingressCarousel.destroy();a.trigger("vse:"+e.vars.clientPrefix+":page:lightBoxClosed")});var B=a.now();l.count(b+
".requestToReadyDuration",B-h);l.count(b+".requestToInitDuration",p-h);l.count(b+".initToReadyDuration",B-p);a.$("#vse-spinner").addClass("aok-hidden");e.vars.emitSushiMetric&&e.emitThumbnailRenderMetric(b+".thumbnailRender",1);e.vars.A.trigger(e.vars.clientPrefix+":vse:ingressCarousel:registered")}else e.vars.showVotes=!1,l.count(f.INGRESS_RV_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1),e.vars.A.trigger("vse-common-assets-carousel-"+g+"-initialization-failed")}catch(D){l.logFatal(f.ATTRIBUTION_NAME+
":"+e.vars.clientPrefix,"Fatal during Ingress carousel initialization.",D),l.count(b+".ingressCarouselInitializationFatal",1),e.vars.A.hide("#"+e.vars.clientPrefix+f.INGRESS_CAROUSEL_SUFFIX)}});a.on("vse:"+e.vars.clientPrefix+":page:lightBoxOpened",function(c){e.vars.lightboxOpened=!0;e.vars.popoverId=c.lightBoxId;e.vars.A.objectIsEmpty(c.assetSpec)&&(e.vars.ingressHasInitialAssetSpec=!1);e.vars.lightboxCarouselRegistered?(e.vars.ingressHasInitialAssetSpec?(e.vars.currentIndex=e.findIndex(c.assetSpec),
e.vars.currentAssetSpec=e.getCurrentlyPlayingVideoInCarouselMarkAsPlaying(e.vars.currentIndex)):(e.vars.currentAssetSpec=e.getActiveAsset(),e.vars.currentIndex=e.vars.currentAssetSpec.index),e.createContinuousPlayPlaylist(e.vars.currentAssetSpec)):(e.vars.currentIndex=e.vars.ingressHasInitialAssetSpec?c.assetSpec.index:0,e.vars.currentAssetSpec=e.vars.ingressHasInitialAssetSpec?c.assetSpec:e.vars.initialVideo,e.vars.ingressHasInitialAssetSpec&&e.vars.A.objectIsEmpty(e.vars.currentAssetSpec.vendorName)&&
(e.vars.currentAssetSpec.vendorName=e.vars.initialVideo.vendorName));e.vars.lightboxOpenedFirstTime&&(e.getDomElements(e.vars.popoverId,e.vars.templateId),e.vars.showLightboxV2Experience&&(e.dom.$wrapper.closest(f.LightboxWrapperSelector).addClass(e.dom.$wrapper.attr("class")),e.addPlayerHoverHandler()),e.vars.showContentCarousel||(e.vars.showVotes=e.shouldShowVotes(e.vars.currentAssetSpec),e.initializeHelpfulVotes()));e.vars.$("body").addClass("vse-lb-no-scroll");e.vars.$("#"+e.vars.popoverId).addClass("vse-lb-opened");
e.show(e.vars.currentAssetSpec);e.startPlaying(e.vars.currentAssetSpec);e.vars.lightboxOpenedFirstTime?(a.trigger("resize",{},{width:g.innerWidth,height:g.innerHeight}),e.vars.showClosedCaptions&&!e.vars.isVideoImmersivePlayer&&e.setupDefaultClosedCaptions()):e.resizeLB();e.attachStickyHeaders();e.vars.isVideoImmersivePlayer&&(c=a.capabilities.isAmazonApp?"vse-vip-lb-mshop":"vse-vip-lb-mweb",e.vars.$(f.VIPLightboxSelector).addClass(c),e.needToUpdateVideoInfoLater()?e.clearCurrentVideoInfo():(e.resetUserActivityTimer(),
e.showVideoImmersivePlayerOverlay()),e.vars.useAutoplayFallback||(e.vars.intervalUserActivityHandlerId=e.userActivityCountDown()),e.initializeVIPControls(),e.vars.lightboxOpenedFirstTime||(e.vars.useMultiCarousel||e.updateSegmentTab(e.vars.currentAssetSpec),e.vars.lightboxCarouselRegistered&&e.vars.videoActionTrayComponents.updateActiveVideoContentId(e.vars.currentAssetSpec.contentId),e.vars.watchAllClicked?e.handleKeepVideoCarouselOpen():e.handleKeepProductCarouselOpen()),a.delay(function(){e.vars.$("body").addClass("vse-vip-body")},
250),e.emitMetric(f.METRIC_VIP_OPEN));e.vars.A.delay(function(){e.dom.$wrapper.find(".vse-lb-container").animate({opacity:1},200)},200);e.dom.$activeVideoOspLink.click(function(a){e.openExternalLinkFromLightBox(a)});e.dom.$activeVideoCRLink.click(function(a){e.openExternalLinkFromLightBox(a)});!e.vars.isMobile&&e.vars.placement&&-1!==e.vars.placement.toLowerCase().indexOf("search")&&e.vars.$("#"+e.vars.popoverId).closest(f.LightboxWrapperSelector).addClass("vse-responsive-lightbox");e.vars.isMobile&&
e.vars.placement&&-1!==e.vars.placement.toLowerCase().indexOf("search")&&e.vars.$("#"+e.vars.popoverId).closest(f.LightboxWrapperSelector).removeClass("vse-responsive-lightbox").removeClass("vse-vertical-lightbox").addClass("vse-vip");e.isImageBlockVIP()&&e.vars.$("#"+e.vars.popoverId).closest(".video-immersive-view-gallery").addClass("vse-vip");q.when("mash").execute("vse-mash-detection",function(a){e.vars.isMshop=!0;e.vars.mShopFactory=a;e.requestMshopFullscreen()});c=w.fetchLatestPageState(a,e.vars.templateId+
"-lazyload-request-ps");e.vars.A.objectIsEmpty(c)?(e.vars.lightboxOpenedFirstTime=!1,l.count(f.LAZY_LOAD_PAGE_STATE_NOT_FOUND_ERROR_KEY+":"+e.vars.clientPrefix,1)):e.vars.lightboxOpenedFirstTime&&(c=a.$.extend({video:{contentID:e.vars.currentAssetSpec.contentId,contentIDType:"ASIN",videoURL:e.vars.currentAssetSpec.videoUrl,imageURL:e.vars.currentAssetSpec.imageURL}},c),ga.getLazyLoadComponents(e.vars.A,e.vars.popoverId,c,function(a,c){e.vars.A.trigger("vse:"+b+":lazyload:"+c.configuration.type+":succeeded")},
function(a,c){e.vars.A.trigger("vse:"+b+":lazyload:"+c.configuration.type+":failed")}),e.vars.lightboxOpenedFirstTime=!1)});a.on("vse:"+e.vars.clientPrefix+":page:lightBoxClosed",function(){e.vars.lightboxOpened&&(e.vars.lightboxOpened=!1,e.vars.ingressHasInitialAssetSpec=!0,e.dom.$wrapper.find(".vse-lb-container").animate({opacity:0}),e.vars.$("body").removeClass("vse-lb-no-scroll"),e.resetStickyHeaders(),e.vars.player.pause(),e.vars.isVideoImmersivePlayer&&(e.vars.$("body").removeClass("vse-vip-body"),
e.clearIntervalUserActivityHandler(),e.vars.lightboxCarouselRegistered&&e.vars.videoActionTrayComponents.reset(),e.emitMetric(f.METRIC_VIP_CLOSE),e.vars.useAutoplayFallback&&!e.vars.vipPlayIconClicked&&(e.emitMetric(f.METRIC_VIP_CLOSE_WITHOUT_PLAY),l.count(e.vars.clientPrefix+":"+f.METRIC_VIP_CLOSE_WITHOUT_PLAY,1)),e.resetVIPControls(),e.vars.useMultiCarousel&&e.vars.multiCarouselExpanded&&e.openCloseMultiCarousel(),e.vars.isMshop&&e.vars.isVideoImmersivePlayer&&e.cancelMshopFullscreen(),e.vars.A.$("#"+
e.vars.templateId+" ."+f.UpNextCancelClassName).click()))});a.on("vse:"+e.vars.clientPrefix+":lazyload:relatedvideos:succeeded",function(){e.resizeLB();e.emitPFORenderMetric(f.METRIC_PFO_RENDER)});a.on("vse:"+e.vars.clientPrefix+":lazyload:relatedvideos:failed",function(){e.vars.isVideoImmersivePlayer?e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" "+f.VIPWatchIconBlockSelector)):e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" div[class^\x3d'div-'][class$\x3d'lb'] .vse-lazyload-spinner"))});a.on("vse:ns:relatedVideos:"+
e.vars.clientPrefix+":hide",function(){e.vars.lightboxOpened&&e.vars.isVideoImmersivePlayer&&e.vars.A.hide(e.vars.A.$("#"+e.vars.templateId+" "+f.VIPWatchIconBlockSelector))});a.on("resize",function(){e.vars.lightboxOpened&&e.resizeLB()});a.on.orientationchange(function(a){!e.vars.isVideoImmersivePlayer&&e.vars.playFullScreenVideo&&(0===a.orientation?e.vars.player.aspectRatio(e.getAspectRatio(f.PORTRAIT)):e.vars.player.aspectRatio(e.getAspectRatio(f.LANDSCAPE)));e.vars.isMobile&&e.vars.lightboxOpened&&
(e.vars.$("#"+e.vars.popoverId).height(g.innerHeight),e.dom.$lbContainer.height(g.innerHeight))})},TestModules:da,Utils:V,_noneFeature:b()}})})};q.when("A","3p-promise").execute("VSE-gatedP-register-VSEComponentAssets-client",function(c,b){z.register("VSEComponentAssets","VSE-VSEComponentAssets-client-registered",ha,b)});q.when("A","a-carousel-constants","a-carousel-framework","a-carousel-transition-slide").execute("vse-video-carousel-transition-registration",function(c,b,a,d){var f=g.vseFeatures||
{};f["vse-video-carousel-transition-strategy"]||(c=new U(c,b,d),a.registerStrategy("transition","vse-video-carousel-transition",c.get()),f["vse-video-carousel-transition-strategy"]=!0)});q.when("A","a-carousel-framework","a-carousel-constants").execute("vse-display-strategy-registration",function(c,b,a){var d=g.vseFeatures||{};d["vse-video-carousel-display-strategy"]||(c=new T(c,a),b.registerStrategy("display","vse-video-carousel-display",c),d["vse-video-carousel-display-strategy"]=!0)})}catch(c){l.logError(f.ATTRIBUTION_NAME,
"Error during VSE AUI module registration.",c),l.count(f.ATTRIBUTION_NAME+".moduleFatal",1)}})()});